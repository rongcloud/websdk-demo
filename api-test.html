
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WebSDK API test</title>
</head>
<body>

<link rel="stylesheet" href="./res/rongcloud.css">
<a href="https://github.com/rongcloud/websdk-demo/blob/master/api-test.html" class="get-source">è·å–æºç </a>

<style>
body{
	font-size:14px;
	line-height:2;
	color:#333;
}
h1,h2{
	margin:0;
}
.panel span{
	display:inline-block;	
	width:60px;
}
.show{
	display:none;
	font-size:12px;
	border:1px solid #ccc;
	padding:10px 30px;
	width:300px;
	overflow:auto;
	position:fixed;
	right:10px;
	top:0;
	bottom:10px;
}
.btns{
	display:none;
}
.btns input,
.btns a{
	font-size:12px;
	margin:20px 10px 0 10px;
}	
.result{
	display:none;
	background:#f5f5f5;
	margin-top:30px;
	width:730px;
	padding:5px;
	overflow:hidden;
}
.result h2{
	font-size:14px;
	margin:0;
	padding:0;
}
.result pre{
	background:#fff;
	border:1px solid #ccc;
	padding:10px;
	font-size:12px;
	font-family:verdana;
	margin:0;
}
.result pre h3{
	margin:0;
	padding:0;
	color:#cd0000;
}
</style>


<!-- 
check.jsæ˜¯åšä¸€äº›ç¯å¢ƒç›‘æµ‹ç”¨çš„ä¸´æ—¶ä»£ç ï¼Œä»…é™å¼€å‘è°ƒè¯•ä½¿ç”¨
-->
<script src="js/pre-check.js"></script>


<script src="//cdn.ronghub.com/RongIMLib-2.2.6.min.js"></script>
<script src="//cdn.ronghub.com/RongEmoji-2.2.4.min.js"></script> 
<script src="//cdn.ronghub.com/RongIMVoice-2.2.4.min.js"></script>

<!-- äºŒæ¬¡å°è£…çš„åˆå§‹åŒ–ä»£ç  -->
<script src="init.js"></script>

<script>
"use strict";
function showTips(data){
	var dom = document.getElementById("show");
		dom.style.display = "block";
	if(data){
		dom.innerHTML += "<li>" + data + "</li>";
	}else{
		dom.innerHTML = "";
	}
}	
function showResult(title,code,start){
	var dom = document.getElementById("result-area");
		dom.style.display = "block";
	

	var now = new Date().getTime();
	var t = document.getElementById("result");
		t.innerHTML = '<h3>' 
					+ title + '  <small>æ‰§è¡Œæ—¶é—´ï¼š'  + (now - start) + 'ms</small>' 
					+ '</h3>' 
					+ JSON.stringify(code,null,"\t");
}

function getTimer(begin){
	var now = new Date().getTime();
	return " time:" + (now - begin) + " ms";
}
</script>

<!-- 
ç”¨æˆ·æ•°æ®ï¼Œç¾¤ç»„æ•°æ®ï¼Œå¥½å‹å…³ç³» å¿…é¡»æœ‰åº”ç”¨æœåŠ¡å™¨æä¾›
æ˜¾ç¤ºä¼šè¯ä¿¡æ¯éœ€è¦ä»èäº‘å’Œåº”ç”¨æœåŠ¡å™¨å…±åŒè·å–æ•°æ®æ‰èƒ½å®Œæ•´æ˜¾ç¤º



å¼€å‘ç¯å¢ƒ 
	é»˜è®¤appkey = 8w7jv4qb78a9yï¼Œå·²ä¸Šçº¿
	å½“å‰ç”¨æˆ·ï¼šuser8
	å¯¹è±¡ç”¨æˆ·ï¼šuser9,user10 

ç”Ÿäº§ç¯å¢ƒ
	82hegw5uh8ktx
	rybznHwVbrk7upeAMWv8RnHEDKuqy0jJayFPsQ4gP8z+SyAuRRg4uk2hA24NDcnvbl6oswAYXQCdpAbHm4pp9g==
-->
<script>
"use strict";
var instance = null;
var appKey = "";
var token = "";

var userId = "";
/*
æ¶ˆæ¯å…¨éƒ¨ç”¨å•èŠï¼Œuser8 -> user9
*/
var targetId = "user9"; // ç›®æ ‡ Id
var targetId2 = "user10"; // ç›®æ ‡ Id
//mockæ•°æ®ï¼Œå®é™…é¡¹ç›®ä»åº”ç”¨æœåŠ¡å™¨è·å–
var usersInfo = {
	"user9" : {
		"userId" : "user9",
		"name" : "å¼ ä¸‰",
		"portraitUri" : "http://rongcloud.cn/images/newVersion/log_wx.png"

	}
};

var conversationtype = RongIMLib.ConversationType.PRIVATE; // ç§èŠ

var begin = 0;

function startInit(){
	appKey = document.getElementById("appkey").value;
	token = document.getElementById("token").value;

	if(appKey == "" || token == ""){
		alert("å¿…é¡»æä¾›appkeyå’Œtoken");
	}

	var targetIds = document.getElementById("targetId").value;
	if(targetIds == ""){
		alert("å¿…é¡»æä¾›ä¸¤ä¸ªçš„æœ‰æ•ˆtargetId");
	}

	targetIds = targetIds.split("ï¼Œ").join(",").split(",");
	targetId = targetIds[0];	
	targetId2 = targetIds[1];	

	showTips();

	begin = new Date().getTime()

	//å…¬æœ‰äº‘åˆå§‹åŒ–
	var config = {
        // protobuf: './local-sdk/protobuf-2.2.7.js' //ä¸‹è½½éƒ¨ç½²åæä¾›å®Œæˆè·¯å¾„
    };

	var params = {
		appKey : appKey,
		token : token
	};

	var callbacks = {
		getInstance : function(_instance){
			instance = _instance;
		},
		receiveNewMessage : function(message){
			// åˆ¤æ–­æ¶ˆæ¯ç±»å‹
		    showTips("æ–°æ¶ˆæ¯ï¼Œç±»å‹ä¸ºï¼š" + message.messageType);
            // showResult("æ–°æ¶ˆæ¯",message,start);

            console.log("messageUId:" + message.messageUId + ",   messageId:" + message.messageId);
            console.log(message);
		},
		getCurrentUser : function(userInfo){
			showTips("é“¾æ¥æˆåŠŸ ç”¨æˆ·idï¼š" + userInfo.userId + ", è€—æ—¶" + getTimer(begin));
			userId = userInfo.userId;
		    afterConnected();
		}
	};
	init(params,callbacks,config);
	showTips("åˆå§‹åŒ– åº”ç”¨ " + getTimer(begin));


	RongIMLib.RongIMEmoji.init();
	showTips("åˆå§‹åŒ– è¡¨æƒ…åº“ " + getTimer(begin));


	RongIMLib.RongIMVoice.init();
	showTips("åˆå§‹åŒ– å£°éŸ³åº“ " + getTimer(begin));
}

function afterConnected(){
	document.getElementById("panel").style.display = "none";
	document.getElementById("btns").style.display = "block";
	// instance = RongIMClient.getInstance();
}

function disconnect(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/RongIMClient.html
	*/

	instance.disconnect();
}

/*
	1: reconnect æ˜¯é‡æ–°è¿æ¥ï¼Œå¹¶æ²¡æœ‰é‡è¿æœºåˆ¶ï¼Œè°ƒç”¨æ­¤æ–¹æ³•å‰åº”è¯¥è¿›è¡Œç½‘ç»œå—…æ¢ï¼Œç½‘ç»œæ­£å¸¸å†è°ƒç”¨ reconnectã€‚
	2: æç¤ºå…¶ä»–è®¾å¤‡ç™»å½•è¯·å‹¿è°ƒç”¨é‡è¿æ–¹æ³•ã€‚
 */
function reconnect(){
	//docs   http://www.rongcloud.cn/docs/api/js/RongIMClient.html
	begin = new Date().getTime();
	RongIMClient.reconnect({
		onSuccess: function(userId) {
			showTips("é‡æ–°é“¾æ¥æˆåŠŸï¼Œç”¨æˆ·idï¼š" + userId + "; " + getTimer(begin));
		},
		onTokenIncorrect: function() {
			//console.log('tokenæ— æ•ˆ');
		},
		onError:function(errorCode){
		  var info = '';
		  switch (errorCode) {
		    case RongIMLib.ErrorCode.TIMEOUT:
		      info = 'è¶…æ—¶';
		      break;
		    case RongIMLib.ErrorCode.UNKNOWN_ERROR:
		      info = 'æœªçŸ¥é”™è¯¯';
		      break;
		    case RongIMLib.ErrorCode.UNACCEPTABLE_PROTOCOL_VERSION:
		      info = 'ä¸å¯æ¥å—çš„åè®®ç‰ˆæœ¬';
		      break;
		    case RongIMLib.ErrorCode.IDENTIFIER_REJECTED:
		      info = 'appkeyä¸æ­£ç¡®';
		      break;
		    case RongIMLib.ErrorCode.SERVER_UNAVAILABLE:
		      info = 'æœåŠ¡å™¨ä¸å¯ç”¨';
		      break;
		  }
		  showTips(info);
		}
	});
}

//æ¶ˆæ¯æ’¤å›å˜é‡åŠè®¾ç½®
var recallMessage = null;
function setRecallMessage(message){
	recallMessage = message;
}

function sendTextMessage(){
	/*
	æ–‡æ¡£ï¼š http://www.rongcloud.cn/docs/web.html#5_1ã€å‘é€æ¶ˆæ¯
		   http://rongcloud.cn/docs/api/js/TextMessage.html
	1: å•æ¡æ¶ˆæ¯æ•´ä½“ä¸å¾—å¤§äº128K
	2: conversatinType ç±»å‹æ˜¯ numberï¼ŒtargetId ç±»å‹æ˜¯ string
	*/

	var content = {
		// content:"hello " + encodeURIComponent('Ï€ï¼ŒÎ±ï¼ŒÎ²'),
		content:"é˜¿æ‹‰ä¼¯è¯­ï¼šØ§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø· ï¼Œå¸Œä¼¯æ¥è¯­ï¼š×”××–×¨×— ×”×ª×™×›×•×Ÿã€‚ ï¼Œï¼Œï¼Œï¼Œhello ğŸ˜Š " + ' Ï€ï¼ŒÎ±ï¼ŒÎ², Â» æ•°å­—å•ä½éƒ¨åˆ†å­—ç¬¦ å¦‚ï¼šÃ— æ‹‰ä¸æ–‡æ‰€æœ‰å­—ç¬¦ å¦‚ï¼šÎŸ Î¡ Ïƒ Ã Ã† æ‹¼éŸ³æ‰€æœ‰å­—ç¬¦ å¦‚ï¼š Ä› Ã¬ Åˆ è‹±æ–‡éŸ³æ ‡éƒ¨åˆ†å­—ç¬¦ å¦‚ ï¼š É™ Êƒ ä¿„æ–‡éƒ¨åˆ†å­—ç¬¦ å¦‚ ï¼šÑˆ ; âŠ‡ Ã¢ Å’ Å  â„¢ ',
		user : {
			"userId" : "this-is-a-test-id",
			"name" : "å¼ ä¸‰",
			"portraitUri" : "http://rongcloud.cn/images/newVersion/log_wx.png"
		},
		extra:{
			"name":"name",
			"age" : 12
		}
	};

	var msg = new RongIMLib.TextMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationtype, targetId, msg, {
        onSuccess: function (message) {
        	setRecallMessage(message);
            showTips("å‘é€æ–‡å­—æ¶ˆæ¯æˆåŠŸ");
            showResult("å‘é€æ–‡å­—æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å‘é€æ–‡å­—æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });
}

function sendImageMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/ImageMessage.html

	ä¸Šä¼ æ’ä»¶æ–‡æ¡£: http://rongcloud.cn/docs/web.html#ä¸Šä¼ æ’ä»¶

	éœ€è¦è‡ªè¡Œè§£å†³æ–‡ä»¶ä¸Šä¼ 
	ç¼©ç•¥å›¾å¿…é¡»æ˜¯base64ç çš„jpgå›¾ï¼Œè€Œä¸”ä¸å¸¦å‰ç¼€"data:image/jpeg;base64,"ï¼Œä¸å¾—è¶…è¿‡100K

	uploadç»„ä»¶ï¼šhttps://github.com/rongcloud/rongcloud-web-im-upload
	*/

	var content = {
		imageUri: "http://rongcloud.cn/images/newVersion/log_wx.png", 
		content: getBase64Image()
	};

	var msg = new RongIMLib.ImageMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationtype, targetId, msg, {
        onSuccess: function (message) {
        	setRecallMessage(message);
            showTips("å‘é€å›¾ç‰‡æ¶ˆæ¯æˆåŠŸ");
            showResult("å‘é€å›¾ç‰‡æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å‘é€å›¾ç‰‡æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });	
}

function sendFileMessage(){
	/*
	uploadç»„ä»¶ï¼šhttps://github.com/rongcloud/rongcloud-web-im-upload
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/ImageMessage.html

	ä¸Šä¼ æ’ä»¶æ–‡æ¡£: http://rongcloud.cn/docs/web.html#ä¸Šä¼ æ’ä»¶

	å•æ¡æ¶ˆæ¯æ•´ä½“ä¸å¾—å¤§äº128K

	æ–‡ä»¶æ¶ˆæ¯åˆ†ä¸¤æ­¥ï¼š
		1ã€ä¸Šä¼ æ–‡ä»¶è‡³æ–‡ä»¶æœåŠ¡å™¨
		2ã€å‘é€æ–‡ä»¶ä¿¡æ¯å’Œæ–‡ä»¶ URL
	*/

	var content = {
	    name: 'log_wx', // æ–‡ä»¶åç§°
	    size: '20k', // æ–‡ä»¶å¤§å°ï¼Œå•ä½è‡ªå·±çº¦å®š
	    type: 'png', // æ–‡ä»¶çš„åç¼€åï¼Œä¾‹å¦‚ pngã€jsã€doc ...
	    fileUrl: 'http://rongcloud.cn/images/newVersion/log_wx.png' // æ–‡ä»¶åœ°å€
	};

	var msg = new RongIMLib.FileMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationtype, targetId, msg, {
        onSuccess: function (message) {
        	setRecallMessage(message);
            showTips("å‘é€æ–‡ä»¶æ¶ˆæ¯æˆåŠŸ");
            showResult("å‘é€æ–‡ä»¶æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å‘é€æ–‡ä»¶æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });	
}

function sendVoiceMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/VoiceMessage.html
		 http://www.rongcloud.cn/docs/web.html#8_1ã€_å£°éŸ³åº“å¼•ç”¨åœ°å€

	éœ€è‡ªè¡Œè§£å†³å½•éŸ³å’Œè½¬ç é—®é¢˜ï¼Œè¦æ±‚ç¼–ç ä¸ºamr

	æ¥æ”¶åˆ°åçš„æ’­æ”¾è¯·è§æ¶ˆæ¯æ¥æ”¶é‡Œçš„ case RongIMClient.MessageType.VoiceMessage
	*/
	var content = {
		content : "å£°éŸ³base64ç ",
		duration : 20
	};
	
	var msg = new RongIMLib.VoiceMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationtype, targetId, msg, {
        onSuccess: function (message) {
        	setRecallMessage(message);
            showTips("å‘é€è¯­éŸ³æ¶ˆæ¯æˆåŠŸ");
            showResult("å‘é€è¯­éŸ³æ¶ˆæ¯æˆåŠŸ",message,start);

            /*
            playè¯­éŸ³æ¶ˆæ¯
			
			var voice = message.content.content;
			var duration = message.content.duration;  //å•ä½ä¸ºç§’
			RongIMLib.RongIMVoice.preLoaded(voice,function(){
				RongIMLib.RongIMVoice.play(voice,duration);
			});
			*/
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å‘é€è¯­éŸ³æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });
}

function registerMessageType(type){
	var messageName = type; // æ¶ˆæ¯åç§°ã€‚
	var objectName = "s:" + type; // æ¶ˆæ¯å†…ç½®åç§°ï¼Œè¯·æŒ‰ç…§æ­¤æ ¼å¼å‘½å *:* ã€‚
	var mesasgeTag = new RongIMLib.MessageTag(true,true);// æ¶ˆæ¯æ˜¯å¦ä¿å­˜æ˜¯å¦è®¡æ•°ï¼Œtrue true ä¿å­˜ä¸”è®¡æ•°ï¼Œfalse false ä¸ä¿å­˜ä¸è®¡æ•°ã€‚
	var propertys = ["name","age","gender"]; // æ¶ˆæ¯ç±»ä¸­çš„å±æ€§åã€‚

	RongIMClient.registerMessageType(messageName,objectName,mesasgeTag,propertys);
}
function sendRegisterMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/web_api_demo.html#è‡ªå®šä¹‰æ¶ˆæ¯

	æ³¨æ„äº‹é¡¹ï¼š
		1ï¼šinitä¹‹å‰æ³¨å†Œæ–°æ¶ˆæ¯ç±»å‹
		2ï¼šå¯¹åº”æ¥æ”¶ onReceived: function (message) {}
			message.messageType == "PersonMessage"
		3ï¼šéœ€è¦è‡ªå·±åšè§£æå®ç°
	*/

	registerMessageType("PersonMessage");

	var content = {
		name:"RegisterMessage",
		age:3,
		gender:"male"
	};

	var msg = new RongIMClient.RegisterMessage.PersonMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationtype, targetId, msg, {
        onSuccess: function (message) {
        	setRecallMessage(message);
            showTips("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯æˆåŠŸ");
            showResult("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });
}

function sendLocationMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/LocationMessage.html

	ç¼©ç•¥å›¾å¿…é¡»æ˜¯base64ç çš„jpgå›¾ï¼Œè€Œä¸”ä¸å¸¦å‰ç¼€"data:image/jpeg;base64,"ï¼Œä¸å¾—è¶…è¿‡100K

	æ³¨æ„äº‹é¡¹ï¼š
		1ï¼šéœ€è¦è‡ªå·±åšæ˜¾ç¤ºæ•ˆæœ
	*/

	var content = {
		"content":getBase64Image(),
		"latitude":"24.114",
		"longitude":"334.221",
		"poi":"åŒ—äº¬å¸‚æœé˜³åŒºåŒ—è‹‘è·¯åŒ—è¾°æ³°å²³å¤§å¦"
	};

	var msg = new RongIMLib.LocationMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationtype, targetId, msg, {
        onSuccess: function (message) {
        	setRecallMessage(message);
            showTips("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯æˆåŠŸ");
            showResult("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯æˆåŠŸ",message,start);
            // showMap(message);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });	

    // function showMap(message){
    // 	var latitude = message.content.latitude;
    // 	var longitude = message.content.longitude;
    // 	var content = message.content.content;
    // 	var poi = message.content.poi;
    // }
}

function SendSyncReadStatusMessage(){
	var sentTime = 1486975569605;// message çš„ sentTimeã€‚
	var content = {
		lastMessageSendTime: sentTime
	};
	var msg = new RongIMLib.SyncReadStatusMessage(content);

	var start = Date.now();
	instance.sendMessage(conversationtype, targetId, msg, {
        onSuccess: function (message) {
            showTips("å‘é€åŒæ­¥æ¶ˆæ¯æˆåŠŸ");
            showResult("å‘é€åŒæ­¥æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å‘é€åŒæ­¥æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });	
}

function sendRecallMessage(){
	if(recallMessage == null){
		alert("è¯·å…ˆå‘é€ä»»æ„ä¸€æ¡æ¶ˆæ¯ä¼šå†æ‰§è¡Œæ’¤å›");
		return;
	}
	//æ¶ˆæ¯æ’¤å›æœåŠ¡å™¨ç«¯æ²¡æœ‰æ—¶é—´é™åˆ¶ï¼Œç”±å®¢æˆ·ç«¯å†³å®š

	var start = Date.now();
	instance.sendRecallMessage(recallMessage, {
        onSuccess: function (message) {
        	console.log(message);
            showTips("æ’¤å›æˆåŠŸ");
            showResult("æ’¤å›æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("æ’¤å›å¤±è´¥",message,start);
        }
    });		
}

function checkUnreadMessage(){
	/*
	http://www.rongcloud.cn/docs/web.html#5_5ã€æ£€æµ‹æ˜¯å¦æœ‰æœªè¯»çš„æ¶ˆæ¯

	æ­¤æ¥å£å¿…é¡»åœ¨init()æ–¹æ³•ä¹‹åè°ƒç”¨ï¼Œä½†ä¸ä¾èµ–äºconnect
	åªè¿”å›true/falseï¼Œä¸è¿”å›å…·ä½“çš„æœªè¯»æ•°é‡
	è‹¥è¿æ¥æˆåŠŸåè°ƒç”¨æ­¤æ–¹æ³•å°†ä¸€ç›´è¿”å› falseã€‚
	*/
	
	var start = new Date().getTime();
	instance.hasRemoteUnreadMessages(token,{
	    onSuccess:function(hasMessage){
	        if(hasMessage){
	            // æœ‰æœªè¯»çš„æ¶ˆæ¯
	        }else{
	            // æ²¡æœ‰æœªè¯»çš„æ¶ˆæ¯
	        }

            showTips("æ£€æŸ¥æœªè¯»æ¶ˆæ¯æˆåŠŸ");
            showResult("æ£€æŸ¥æœªè¯»æ¶ˆæ¯æˆåŠŸ",hasMessage,start);

	    },onError:function(err){
            showTips("æ£€æŸ¥æœªè¯»æ¶ˆæ¯å¤±è´¥");
            showResult("æ£€æŸ¥æœªè¯»æ¶ˆæ¯å¤±è´¥",err,start);
	    }
	});
}

function getHistroyMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/web_api_demo.html#è·å–å†å²æ¶ˆæ¯
	å†å²æ¶ˆæ¯äº‘å­˜å‚¨å¼€é€šä½ç½®ï¼šhttps://developer.rongcloud.cn/service/roam/rXxI4IAJjxRAD72SpQ==

	æ³¨æ„äº‹é¡¹ï¼š
		1ï¼šä¸€å®šä¸€å®šä¸€å®šè¦å…ˆå¼€é€š å†å²æ¶ˆæ¯äº‘å­˜å‚¨ åŠŸèƒ½ï¼Œæœ¬æœåŠ¡æ”¶è´¹ï¼Œæµ‹è¯•ç¯å¢ƒå¯å…è´¹å¼€é€š
		2ï¼štimestrapç¬¬äºŒæ¬¡æ‹‰å–å¿…é¡»ä¸ºnullæ‰èƒ½å®ç°å¾ªç¯æ‹‰å–
	*/

	var count = 3;  // 2 <= count <= 20
	var timestrap = null; //0, 1483950413013

	var start = new Date().getTime();
	instance.getHistoryMessages(conversationtype, targetId, timestrap, count, {
		onSuccess: function(list, hasMsg) {
			//å¯é€šè¿‡sortè®¢åˆ¶å…¶ä»–é¡ºåº
			console.log(list.length);
			console.log(hasMsg);
			list.sort(function(a,b){
				return a.sentTime < b.sentTime;
			});

            showTips("è·å–å†å²æ¶ˆæ¯æˆåŠŸ");
            showResult("è·å–å†å²æ¶ˆæ¯æˆåŠŸ",list,start);
		},
		onError: function(error) {
            showTips("è·å–å†å²æ¶ˆæ¯å¤±è´¥");
            showResult("è·å–å†å²æ¶ˆæ¯å¤±è´¥",error,start);
		}
	});
} 

function getConversationList(){	
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/web_api_demo.html#ä¼šè¯æ¥å£
		 http://www.rongcloud.cn/docs/web.html#5_2ã€åŒæ­¥ä¼šè¯åˆ—è¡¨
		 http://www.rongcloud.cn/docs/api/js/RongIMClient.html

	å†å²æ¶ˆæ¯äº‘å­˜å‚¨å¼€é€šä½ç½®ï¼šhttps://developer.rongcloud.cn/service/roam/rXxI4IAJjxRAD72SpQ==

	æ³¨æ„äº‹é¡¹ï¼š
		1ï¼šä¸€å®šä¸€å®šä¸€å®šè¦å…ˆå¼€é€š å†å²æ¶ˆæ¯äº‘å­˜å‚¨ åŠŸèƒ½ï¼Œæœ¬æœåŠ¡æ”¶è´¹ï¼Œæµ‹è¯•ç¯å¢ƒå¯å…è´¹å¼€é€š
		2ï¼šåªæœ‰å‘è¿‡æ¶ˆæ¯æ‰èƒ½ç”Ÿæˆä¼šè¯
	*/

	var conversationTypes = null;  //å…·ä½“æ ¼å¼è®¾ç½®éœ€è¦è¡¥å……
	var limit = 10; //è·å–ä¼šè¯çš„æ•°é‡ï¼Œä¸ä¼ æˆ–ä¼ nullä¸ºå…¨éƒ¨ï¼Œæš‚ä¸æ”¯æŒåˆ†é¡µ
	var start = new Date().getTime();
	instance.getConversationList({
		onSuccess: function(list) {
			// list.sort(function(a,b){
			// 	return a.sentTime > b.sentTime;
			// });

			// list = jQuery.grep(list, function(n,i){
			// 	return (n!== 5 && i>4)
			// });

			// // console.log(list)
			// $.each(list,function(i,e){
			// 	// console.log(e);
			// 	console.log($(e));
			// });
			var title = "æˆåŠŸè·å– " + list.length + " ä¸ªä¼šè¯";
            showTips(title);
            showResult(title,list,start);
		},
		onError: function(error) {
            showTips("è·å–ä¼šè¯å¤±è´¥");
            showResult("è·å–ä¼šè¯å¤±è´¥",error,start);
		}
    },conversationTypes,limit);
}

function removeConversation(){
	var start = new Date().getTime();
	instance.removeConversation(conversationtype, targetId, { 
		onSuccess:function(result){ 
            showResult("åˆ é™¤ä¼šè¯æˆåŠŸ",result,start);
		}, 
		onError:function(error){ 
		// error => æ¸…é™¤ä¼šè¯é”™è¯¯ç ã€‚ 
		    showResult("åˆ é™¤ä¼šè¯å¤±è´¥",error,start);
		} 
	});
}

function clearConversation(){
	var start = new Date().getTime();
	instance.clearConversations({ 
		onSuccess:function(){ 
            showResult("æ¸…é™¤ä¼šè¯æˆåŠŸ",null,start);
		}, 
		onError:function(error){ 
		// error => æ¸…é™¤ä¼šè¯é”™è¯¯ç ã€‚ 
		    showResult("æ¸…é™¤ä¼šè¯å¤±è´¥",error,start);
		} 
	});
}

function getUnreadCount(){
	/*
		æ³¨æ„äº‹é¡¹ï¼š

		è·å–æœªè¯»æ¶ˆæ¯æ•°å¿…é¡»åœ¨è·å–ä¼šè¯åˆ—è¡¨å’Œæ”¶åˆ°å®æ—¶æ¶ˆæ¯ä¹‹å

		æœªè¯»æ¶ˆæ¯æ•°å­˜åœ¨ localStorage ä¸­


	 */
	var start = Date.now();
	instance.getUnreadCount(conversationtype,targetId,{
	    onSuccess:function(count){
	       showTips("è·å–ä¼šè¯æœªè¯»æ•°æˆåŠŸ");
	       showResult("è·å–ä¼šè¯æœªè¯»æ•°æˆåŠŸ", count, start);
	    },
	    onError:function(error){
	       showTips("è·å–ä¼šè¯æœªè¯»æ•°å¤±è´¥");
	       showResult("è·å–ä¼šè¯æœªè¯»æ•°å¤±è´¥", error, start);
	    }
	});
}

function getTotalUnreadCount(){
	/*
		æ³¨æ„äº‹é¡¹ï¼š

		è·å–æœªè¯»æ¶ˆæ¯æ•°å¿…é¡»åœ¨è·å–ä¼šè¯åˆ—è¡¨å’Œæ”¶åˆ°å®æ—¶æ¶ˆæ¯ä¹‹å

		æœªè¯»æ¶ˆæ¯æ•°å­˜åœ¨ localStorage ä¸­

	 */
	var start = Date.now();
	instance.getTotalUnreadCount({
	  onSuccess:function(count){
	       showTips("è·å–æ€»æœªè¯»æ•°æˆåŠŸ");
	       showResult("è·å–æ€»æœªè¯»æ•°æˆåŠŸ", count, start);
	  },
	  onError:function(error){
	      showTips("è·å–æ€»æœªè¯»æ•°å¤±è´¥");
	      showResult("è·å–æ€»æœªè¯»æ•°å¤±è´¥", error, start);
	  }
	});
}

function clearUnreadCount(){
	/*
		æ³¨æ„äº‹é¡¹ï¼š

	 	æ­¤æ–¹æ³•æ¸…é™¤å½“å‰ç«¯çš„æœªè¯»æ•°ï¼Œå¹¶ä¸ä¼šå¤šç«¯åŒæ­¥ï¼Œå¤šç«¯åŒæ­¥éœ€è¦å‘é€ SyncReadStatusMessage 	åŒæ­¥ç»™å¤šç«¯ è¯·å‚è€ƒ SendSyncReadStatusMessageã€‚
	 	
	 */

	var start = Date.now();
	instance.clearUnreadCount(conversationtype,targetId,{
	    onSuccess:function(){
	        showTips("æ¸…é™¤æœªè¯»æ•°æˆåŠŸ");
	        showResult("æ¸…é™¤æœªè¯»æ•°æˆåŠŸ", "success", start);
	    },
	    onError:function(error){
	    	showTips("æ¸…é™¤æœªè¯»æ•°å¤±è´¥");
	        showResult("æ¸…é™¤æœªè¯»æ•°å¤±è´¥", error, start);
	    }
	});
}


function receiveMessage(){
	alert("è¯·è§initæ–¹æ³•é‡Œçš„ RongIMClient.setOnReceiveMessageListener")
}


//åŠ å…¥èŠå¤©å®¤åï¼Œå¯ä»¥ç”¨ä»»æ„ä¸€ä¸ªå‘é€æ¶ˆæ¯çš„æ–¹æ³•å‘é€æ¶ˆæ¯ï¼Œåªéœ€è¦conversationTypeä¸ºCHATROOM
var chatRoomId = "chatRoomId-008"; // èŠå¤©å®¤ Id,å¯ä»»æ„æŒ‡å®šï¼Œèƒ½åŒºåˆ†ä¸åŒèŠå¤©å®¤å³å¯
var count = 10; //æ‹‰å–æœ€è¿‘çš„ä¼šè¯å†…å®¹ï¼ˆæœ€è¿‘ n ( n <= 50 )æ¡ï¼‰ 

function enterChatroom(){
	/*
	http://www.rongcloud.cn/docs/web_api_demo.html#èŠå¤©å®¤

	èŠå¤©å®¤ä¸æ”¯æŒé€šè¿‡ getHistoryMessages æ–¹æ³•è·å–å†å²æ¶ˆæ¯ï¼Œ
	å¯ä»¥åœ¨ joinChatRoom æ—¶æ‹‰å–æœ€è¿‘çš„æ¶ˆæ¯, æœ€å¤š 50 æ¡ã€‚
	*/

	var start = new Date().getTime();
	instance.joinChatRoom(chatRoomId, count, {
		onSuccess: function() {
            showTips("åŠ å…¥èŠå¤©å®¤æˆåŠŸ");
            showResult("åŠ å…¥èŠå¤©å®¤æˆåŠŸ",null,start);
		},
		onError: function(error) {
            showTips("åŠ å…¥èŠå¤©å®¤å¤±è´¥");
            showResult("åŠ å…¥èŠå¤©å®¤å¤±è´¥",null,start);
		}
	});
}

function quitChatroom(){
	var start = new Date().getTime();
	instance.quitChatRoom(chatRoomId, {
		onSuccess: function() {
            showTips("é€€å‡ºèŠå¤©å®¤æˆåŠŸ");
            showResult("é€€å‡ºèŠå¤©å®¤æˆåŠŸ",null,start);
		},
		onError: function(error) {
            showTips("é€€å‡ºèŠå¤©å®¤å¤±è´¥");
            showResult("é€€å‡ºèŠå¤©å®¤å¤±è´¥",null,start);
		}
	});
}

function getChatroomInfo(){
	/*
	éœ€ç¡®è®¤ å½“å‰ç”¨æˆ· å·²åŠ å…¥èŠå¤©å®¤
	*/ 
	var order = RongIMLib.GetChatRoomType.REVERSE;// æ’åºæ–¹å¼ã€‚
	var memberCount = 10; // è·å–èŠå¤©å®¤äººæ•° ï¼ˆèŒƒå›´ 0-20 ï¼‰

	var start = new Date().getTime();
	instance.getChatRoomInfo(chatRoomId, memberCount, order, {
	  onSuccess: function(chatRoom) {
			// chatRoom => èŠå¤©å®¤ä¿¡æ¯ã€‚
			// chatRoom.userInfos => è¿”å›èŠå¤©å®¤æˆå‘˜ã€‚
			// chatRoom.userTotalNums => å½“å‰èŠå¤©å®¤æ€»äººæ•°ã€‚
            showTips("è·å–èŠå¤©å®¤ä¿¡æ¯æˆåŠŸ");
            showResult("è·å–èŠå¤©å®¤ä¿¡æ¯æˆåŠŸ",chatRoom,start);
	  },
	  onError: function(error) {
            showTips("è·å–èŠå¤©å®¤ä¿¡æ¯å¤±è´¥");
            showResult("è·å–å¤©å®¤ä¿¡æ¯å¤±è´¥",error);
	  }
	});
}

function sendMessageToChatroom(){
	var content = {
		content:"helloï¼Œtimeï¼š" + new Date().getTime(),
		extra:"RongCloud"
	};

	var conversationtype = RongIMLib.ConversationType.CHATROOM; // ç§èŠ
	var msg = new RongIMLib.TextMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationtype, chatRoomId, msg, {
        onSuccess: function (message) {
            showTips("å‘é€èŠå¤©å®¤æ¶ˆæ¯æˆåŠŸ");
            showResult("å‘é€èŠå¤©å®¤æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å‘é€èŠå¤©å®¤æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });
}


var discussionName = "shuise`s discussion"; // åç§°è‡ªå®šä¹‰
var userIds = [userId,targetId];//è®¨è®ºç»„åˆå§‹æˆå‘˜ã€‚
var discussionId;

function getDiscussionInfo(discussionId,start){
	instance.getDiscussion(discussionId,{
		onSuccess:function(discussion){
			showResult("è®¨è®ºç»„ä¿¡æ¯è·å–æˆåŠŸ",discussion,start);
		},
		onError:function(error){
            showTips(error);
            showResult("è®¨è®ºç»„ä¿¡æ¯è·å–å¤±è´¥",error,start);
		}
	});
}

function createDiscussion(){
	/*
	http://www.rongcloud.cn/docs/web_api_demo.html#è®¨è®ºç»„
	
	*/ 
	var start = new Date().getTime();
	instance.createDiscussion(discussionName,userIds,{
	    onSuccess:function(discussionId){
	    	window.discussionId = discussionId;
            showTips("è®¨è®ºç»„åˆ›å»ºæˆåŠŸ");

			getDiscussionInfo(discussionId,start);
	    },
	    onError:function(error){
            showTips(error);
            showResult("è®¨è®ºç»„åˆ›å»ºå¤±è´¥",error,start);
	    }
	});
}

function setDiscussionName(){
	var start = new Date().getTime();
	var discusstionName = "another discussion";

	instance.setDiscussionName(discussionId,discusstionName,{
	    onSuccess:function(){
            showTips("è®¨è®ºç»„æ”¹åæˆåŠŸ");
            showResult("è®¨è®ºç»„æ”¹åæˆåŠŸ",null,start);

            getDiscussionInfo(discussionId,start);
	    },
	    onError:function(error){
            showTips("è®¨è®ºç»„æ”¹åå¤±è´¥");
            showResult("è®¨è®ºç»„æ”¹åå¤±è´¥",error,start);
	    }
	});
}

function setDiscussionStatus(){
	var status = RongIMLib.DiscussionInviteStatus.CLOSED; 
	/* è®¨è®ºé‚€è¯·çŠ¶æ€ ï¼Œé»˜è®¤å¼€æ”¾
	0 ï¼š å¼€å‘é‚€è¯·ï¼Œ
	1ï¼šå…³é—­é‚€è¯·  
	RongIMLib.DiscussionInviteStatus.OPEND
	RongIMLib.DiscussionInviteStatus.CLOSED
	*/
	var start = new Date().getTime();
	instance.setDiscussionInviteStatus(discussionId,status,{
	    onSuccess:function(){
            showTips("è®¨è®ºç»„çŠ¶æ€ä¿®æ”¹æˆåŠŸ");
            // showResult("è®¨è®ºç»„çŠ¶æ€ä¿®æ”¹æˆåŠŸ",null,start);

            getDiscussionInfo(discussionId, start);
	    },
	    onError:function(error){
            showTips("è®¨è®ºç»„çŠ¶æ€ä¿®æ”¹æˆåŠŸ");
            showResult("è®¨è®ºç»„çŠ¶æ€ä¿®æ”¹æˆåŠŸ",error,start);
	    }
	});
}

function addMemberToDiscussion(){
	var userIds = [targetId2];//è¢«é‚€è¯·æˆå‘˜ã€‚

	var start = new Date().getTime();
	instance.addMemberToDiscussion(discussionId,userIds,{
	    onSuccess:function(){
            showTips("è®¨è®ºç»„åŠ äººæˆåŠŸ");
            // showResult("è®¨è®ºç»„åŠ äººæˆåŠŸ",null,start);

            getDiscussionInfo(discussionId, start);
	    },
	    onError:function(error){
            showTips("è®¨è®ºç»„åŠ äººå¤±è´¥");
            showResult("è®¨è®ºç»„åŠ äººå¤±è´¥",error,start);
	    }
	});
}

function removeMemberFromDiscussion(){
	var userIds = targetId2;//è¢«é‚€è¯·æˆå‘˜ã€‚

	var start = new Date().getTime();

	instance.removeMemberFromDiscussion(discussionId,userIds,{
	    onSuccess:function(){
            showTips("è®¨è®ºç»„è¸¢äººæˆåŠŸ");
            // showResult("è®¨è®ºç»„è¸¢äººæˆåŠŸ",null,start);

            getDiscussionInfo(discussionId, start);
	    },
	    onError:function(error){
            showTips("è®¨è®ºç»„åŠ äººå¤±è´¥");
            showResult("è®¨è®ºç»„åŠ äººå¤±è´¥",error,start);
	    }
	});
}

function quitDiscussion(){
	var start = new Date().getTime();

	instance.quitDiscussion(discussionId,{
	    onSuccess:function(){
            showTips("é€€å‡ºè®¨è®ºç»„ æˆåŠŸ");
            // showResult("è®¨è®ºç»„è¸¢äººæˆåŠŸ",null,start);

            getDiscussionInfo(discussionId, start);
	    },
	    onError:function(error){
	    	showTips("é€€å‡ºè®¨è®ºç»„ å¤±è´¥");
	    	showResult("é€€å‡ºè®¨è®ºç»„ å¤±è´¥",error,start);
	    }
	});
}


/*
å…¬ä¼—å·
RongIMLib.ConversationType = {
	APP_PUBLIC_SERVICE : "åº”ç”¨æœåŠ¡å¹³å° mc",
	PUBLIC_SERVICE : "å…¬ä¼—æœåŠ¡å¹³å° mp"
};
*/

var publicServiceType = RongIMLib.ConversationType.APP_PUBLIC_SERVICE; //å›ºå®šå€¼
var publicServiceId = "Rong_shuise"; //RongCloud
var searchType = 1; //[0-exact 1-fuzzy]
var keywords = "Rong";
// var keywords = "test";

/*
ç”¨æˆ·ç»™å…¬ä¼—å·å‘æ¶ˆæ¯
var conversationtype = RongIMLib.ConversationType.PUBLIC_SERVICE;
var targetId = publicServiceId
*/

function sendToPublic(){
	/*
	æ–‡æ¡£ï¼š http://www.rongcloud.cn/docs/web.html#5_1ã€å‘é€æ¶ˆæ¯
		   http://rongcloud.cn/docs/api/js/TextMessage.html
	1: å•æ¡æ¶ˆæ¯æ•´ä½“ä¸å¾—å¤§äº128K
	2: conversatinType ç±»å‹æ˜¯ numberï¼ŒtargetId ç±»å‹æ˜¯ string
	*/

	var content = {
		// content:"hello " + encodeURIComponent('Ï€ï¼ŒÎ±ï¼ŒÎ²'),
		content:"å…¬ä¼—å·ä½ å¥½"
	};

	var msg = new RongIMLib.TextMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(publicServiceType, "Rong_shuise", msg, {
        onSuccess: function (message) {
            showTips("å…¬ä¼—å·ç•™è¨€ æˆåŠŸ");
            showResult("å…¬ä¼—å·ç•™è¨€ æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showTips(errorCode);
            showResult("å…¬ä¼—å·ç•™è¨€ å¤±è´¥",message,start);
        }
    });
}

function getPublicHistroyMessage(){
	alert("æš‚ä¸æ”¯æŒ");
	var count = 10;  // 2 <= count <= 20
	var timestrap = null; //0, 1483950413013

	var start = new Date().getTime();
	instance.getHistoryMessages(publicServiceType, "Rong_shuise", timestrap, count, {
		onSuccess: function(list, hasMsg) {
			//å¯é€šè¿‡sortè®¢åˆ¶å…¶ä»–é¡ºåº
			console.log(list.length);
			console.log(hasMsg);
			list.sort(function(a,b){
				return a.sentTime < b.sentTime;
			});

            showTips("è·å–å…¬ä¼—å·å†å²æ¶ˆæ¯æˆåŠŸ");
            showResult("è·å–å…¬ä¼—å·å†å²æ¶ˆæ¯æˆåŠŸ",list,start);
		},
		onError: function(error) {
            showTips("è·å–å…¬ä¼—å·å†å²æ¶ˆæ¯å¤±è´¥");
            showResult("è·å–å…¬ä¼—å·å†å²æ¶ˆæ¯å¤±è´¥",error,start);
		}
	});
} 

function getPublicServiceList(){
	/* 
	getRemotePublicServiceList = function (mpId, conversationType, pullMessageTime, callback)  
	*/ 
	var start = new Date().getTime();

	instance.getPublicServiceList({
	    onSuccess:function(list){
            showTips("è·å–å·²å…³æ³¨å…¬ä¼—å· æˆåŠŸ");
            showResult("è·å–å·²å…³æ³¨å…¬ä¼—å· æˆåŠŸ",list,start);
	    },
	    onError:function(error){
	    	showTips("è·å–å·²å…³æ³¨å…¬ä¼—å· å¤±è´¥");
	    	showResult("æœç´¢è·å–å·²å…³æ³¨å…¬ä¼—å·å…¬ä¼—å· å¤±è´¥",error,start);
	    }
	});
}

function searchPublicService(){
	console.log(searchPublicService);
	/*
	WebAPIæ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/RongIMClient.html
	iOSæ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/ios_imlib.html#å…¬ä¼—æœåŠ¡
	*/ 
	var start = new Date().getTime();

	instance.searchPublicService(searchType, keywords, {
	    onSuccess:function(list){
            showTips("æŸ¥æ‰¾å…¬ä¼—å· æˆåŠŸ");
            showResult("æŸ¥æ‰¾å…¬ä¼—å· æˆåŠŸ",list,start);
	    },
	    onError:function(error){
	    	showTips("æŸ¥æ‰¾å…¬ä¼—å· å¤±è´¥");
	    	showResult("æŸ¥æ‰¾å…¬ä¼—å· å¤±è´¥",error,start);
	    }
	});
}

// function searchPublicServiceByType(){
// 	var start = new Date().getTime();

// 	instance.searchPublicServiceByType(publicServiceType, searchType, keywords, {
// 	    onSuccess:function(list){
//             showTips("æœç´¢å…¬ä¼—å·by type æˆåŠŸ");
//             showResult("æœç´¢å…¬ä¼—å·by type æˆåŠŸ",list,start);
// 	    },
// 	    onError:function(error){
// 	    	showTips("æœç´¢å…¬ä¼—å·by type å¤±è´¥");
// 	    	showResult("æœç´¢å…¬ä¼—å·by type å¤±è´¥",error,start);
// 	    }
// 	});
// }

function subscribePublicService(){
	/*
	http://www.rongcloud.cn/docs/api/js/RongIMClient.html

	*/
	var start = new Date().getTime();

	instance.subscribePublicService(publicServiceType, publicServiceId, {
	    onSuccess:function(list){
            showTips("è®¢é˜…å…¬ä¼—å· æˆåŠŸ");
            showResult("è®¢é˜…å…¬ä¼—å· æˆåŠŸ",list,start);
	    },
	    onError:function(error){
	    	showTips("è®¢é˜…å…¬ä¼—å· å¤±è´¥");
	    	showResult("è®¢é˜…å…¬ä¼—å· å¤±è´¥",error,start);
	    }
	});
}

function unsubscribePublicService(){
	/*
	http://www.rongcloud.cn/docs/api/js/RongIMClient.html
	
	*/
	var start = new Date().getTime();

	instance.unsubscribePublicService(publicServiceType, publicServiceId, {
	    onSuccess:function(list){
            showTips("å–æ¶ˆè®¢é˜…å…¬ä¼—å· æˆåŠŸ");
            showResult("å–æ¶ˆè®¢é˜…å…¬ä¼—å· æˆåŠŸ",list,start);
	    },
	    onError:function(error){
	    	showTips("å–æ¶ˆè®¢é˜…å…¬ä¼—å· å¤±è´¥");
	    	showResult("å–æ¶ˆè®¢é˜…å…¬ä¼—å· å¤±è´¥",error,start);
	    }
	});
}

function getPublicServiceProfile(){
	/*
	http://www.rongcloud.cn/docs/api/js/RongIMClient.html

	å¿…é¡»æ˜¯å·²ç»å…³æ³¨çš„å…¬ä¼—å·ï¼Œæ‰èƒ½è·å–åˆ°è¯¦æƒ…
	*/
	var start = new Date().getTime();

	instance.getPublicServiceProfile(publicServiceType, publicServiceId, {
		onSuccess:function(profile){
            showTips("è·å–å…¬ä¼—å·è¯¦æƒ… æˆåŠŸ");
            showResult("è·å–å…¬ä¼—å·è¯¦æƒ… æˆåŠŸ",profile,start);
  			console.log(profile);
		},
	  	onError:function(){
	  		cosnole.log("è·å–å…¬ä¼—å·è¯¦æƒ… error");
	  	}
	});
}


function upload(){
	window.open('http://rongcloud.cn/docs/web.html#ä¸Šä¼ æ’ä»¶');
}

//è·å–base64å‡æ•°æ®æ–¹æ³•
function getBase64Image(){
	var canvas = document.createElement("canvas");
		canvas.width = 100;
		canvas.height = 100;


	var context = canvas.getContext("2d");	
		context.font = "20pt Arial";    			
		context.fillStyle = "blue"; 
		context.fillText("RongCloud.cn", 10, 20);
	var content = canvas.toDataURL("image/jpeg");
		content = content.replace("data:image/jpeg;base64,","");
	return content;
}
</script>



<h1>Web SDK demo</h1>
<div class="panel" id="panel">
	<p>
		<span>appkey</span>
		<input type="text" id="appkey" size="20" value="8w7jv4qb78a9y">
	</p>
	<p>
		<span>token</span>
		<input type="text" id="token" size="110" value="4FGCL0oQ/E72nU4ivbui8uHR/ySxKaD1cAX2biXsYR6RsLYO9xAA4ooa+q3n42JnVTQyMAdFUiDsjFRDYZaQeg==">
		<!-- 
		8w7jv4qb78a9y
		user9	ZThhLI1Xa1BX5EMREAdArWSH6ouuI8NT/fNmMkzF+4IOKIoFvbsi6JnH8QmnSltLkCcsK8vOgKl3IZgfbxFiWg==
		user10	4FGCL0oQ/E72nU4ivbui8uHR/ySxKaD1cAX2biXsYR6RsLYO9xAA4ooa+q3n42JnVTQyMAdFUiDsjFRDYZaQeg== 
		-->

		<!-- 
		82hegw5uh8ktx
		rybznHwVbrk7upeAMWv8RnHEDKuqy0jJayFPsQ4gP8z+SyAuRRg4uk2hA24NDcnvbl6oswAYXQCdpAbHm4pp9g==
		-->
	</p>
	<p>
		<span>targetIds</span>
		<input type="text" id="targetId" size="25" value="user9,user8">
		<em>é€—å·é—´éš”ï¼Œè‡³å°‘æä¾›ä¸¤ä¸ª</em>
	</p>
	<p>
		<span>&#160;</span>
		<input type="button" onclick="startInit()" value="åˆå§‹åŒ–">  &#160;&#160;<strong>æ‰€æœ‰ä¸šåŠ¡æ–¹æ³•éƒ½å¿…é¡»åœ¨ é“¾æ¥æˆåŠŸ ä¹‹åæ‰§è¡Œ</strong>
	</p>
</div>

<div class="btns" id="btns">
	é“¾æ¥çŠ¶æ€ï¼š
	<input type="button" value="æ–­å¼€é“¾æ¥" onclick="disconnect();">
	<input type="button" value="é‡æ–°é“¾æ¥" onclick="reconnect();">

	<br>


	å‘é€æ¶ˆæ¯ï¼š
	<input type="button" value="æ–‡å­—æ¶ˆæ¯" onclick="sendTextMessage();">
	<input type="button" value="å›¾ç‰‡æ¶ˆæ¯" onclick="sendImageMessage();">
	<input type="button" value="æ–‡ä»¶æ¶ˆæ¯" onclick="sendFileMessage();">
	<input type="button" value="è¯­éŸ³æ¶ˆæ¯" onclick="sendVoiceMessage();">
	<input type="button" value="è‡ªå®šä¹‰æ¶ˆæ¯" onclick="sendRegisterMessage();">
	<input type="button" value="ä½ç½®æ¶ˆæ¯" onclick="sendLocationMessage();"> 
	<input type="button" value="æ¶ˆæ¯æ’¤å›" onclick="sendRecallMessage();"> 

	<br>

	æ¥æ”¶æ¶ˆæ¯ï¼š
	<input type="button" value="åŒæ­¥çŠ¶æ€æ¶ˆæ¯" onclick="SendSyncReadStatusMessage();">
	<input type="button" value="æ£€æŸ¥æœªè¯»æ¶ˆæ¯" onclick="checkUnreadMessage();"> 
	<input type="button" value="æ¶ˆæ¯æ¥æ”¶" onclick="receiveMessage();"> 
	<input type="button" value="å†å²æ¶ˆæ¯" onclick="getHistroyMessage();"> 

	<br>

	ä¼š&nbsp;&nbsp;è¯ï¼š
	<input type="button" value="ä¼šè¯åˆ—è¡¨" onclick="getConversationList();">
	<input type="button" value="ä¼šè¯æœªè¯»æ•°" onclick="getUnreadCount();"> 
	<input type="button" value="ä¼šè¯æœªè¯»æ€»æ•°" onclick="getTotalUnreadCount();"> 
	<input type="button" value="æ¸…é™¤ä¼šè¯æœªè¯»æ•°" onclick="clearUnreadCount();">
	<input type="button" value="åˆ é™¤æŒ‡å®šä¼šè¯" onclick="removeConversation();">
	<input type="button" value="åˆ é™¤æ‰€æœ‰ä¼šè¯" onclick="clearConversation();">

	<br>

	èŠ å¤© å®¤ï¼š
	<input type="button" value="åŠ å…¥èŠå¤©å®¤" onclick="enterChatroom();"> 
	<input type="button" value="èŠå¤©å®¤å‘æ¶ˆæ¯" onclick="sendMessageToChatroom();"> 
	<input type="button" value="é€€å‡ºèŠå¤©å®¤" onclick="quitChatroom();"> 
	<input type="button" value="è·å–èŠå¤©å®¤ä¿¡æ¯" onclick="getChatroomInfo();"> 

	<br>

	è®¨è®ºç»„ï¼š
	<input type="button" value="è®¨è®ºç»„åˆ›å»º" onclick="createDiscussion();"> 
	<input type="button" value="è®¨è®ºç»„æ”¹å" onclick="setDiscussionName();"> 
	<input type="button" value="è®¨è®ºç»„çŠ¶æ€" onclick="setDiscussionStatus();"> 
	<input type="button" value="è®¨è®ºç»„åŠ äºº" onclick="addMemberToDiscussion();"> 
	<input type="button" value="è®¨è®ºç»„è¸¢äºº" onclick="removeMemberFromDiscussion();"> 
	<input type="button" value="é€€å‡ºè®¨è®ºç»„" onclick="quitDiscussion();"> 
	<br><em style="margin-left:5em;">è®¨è®ºç»„å·²ç»åœæ­¢æ›´æ–°ï¼Œå¼ºçƒˆä¸æ¨èä½¿ç”¨ï¼Œå»ºè®®ä½¿ç”¨ç¾¤ç»„æ›¿ä»£</em>
	<br>

	å…¬ä¼—æœåŠ¡ï¼š
	<input type="button" value="è·å–å·²å…³æ³¨å…¬ä¼—å·" onclick="getPublicServiceList();"> 
	<input type="button" value="æŸ¥æ‰¾å…¬ä¼—å·" onclick="searchPublicService();"> 
	<!-- <input type="button" value="æŸ¥æ‰¾å…¬ä¼—å· byType" onclick="searchPublicServiceByType();">  -->
	<input type="button" value="è®¢é˜…å…¬ä¼—å·" onclick="subscribePublicService();"> 
	<input type="button" value="å–æ¶ˆè®¢é˜…å…¬ä¼—å·" onclick="unsubscribePublicService();"> 
	<input type="button" value="è·å–å…¬ä¼—å·ä¿¡æ¯" onclick="getPublicServiceProfile();"> 
	<input type="button" value="ç»™å…¬ä¼—å·ç•™è¨€" onclick="sendToPublic();"> 
	<input type="button" value="å…¬ä¼—å·å†å²ç•™è¨€" onclick="getPublicHistroyMessage();"> 
	
	<br>
	<br>
</div>

<div class="result" id="result-area">
	<!-- <h2>è¿è¡Œç»“æœï¼š</h2> -->
	<pre id="result"></pre>
</div>


<ol id="show" class="show"></ol>

</body>
</html>