
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WebSDK API test</title>
</head>
<body>

<link rel="stylesheet" href="./res/rongcloud.css">
<a href="https://github.com/rongcloud/websdk-demo/blob/master/api-test.html" class="get-source">è·å–æºç </a>

<style>
	body{
		font-size:14px;
		line-height:2;
		color:#333;
	}
	h1,h2,h3{
		margin:0;
	}
	.panel span{
		display:inline-block;	
		width:60px;
	}
	.show{
		display:none;
		font-size:12px;
		border:1px solid #ccc;
		background:#fff;
		padding:10px 30px;
		width:300px;
		overflow:auto;
		position:fixed;
		right:10px;
		top:0;
		bottom:10px;
	}
	.btns{
		display:none;
	}
	.btns input,
	.btns a{
		font-size:12px;
		margin:20px 10px 0 10px;
	}	
	.result{
		display:none;
		background:#f5f5f5;
		margin-top:30px;
		width:730px;
		padding:5px;
		overflow:hidden;
	}
	.result h2{
		font-size:14px;
		margin:0;
		padding:0;
	}
	.result btn{
		margin:5px;
		padding:0;
		color:#cd0000;
	}
	.result-code{
		float:right;
		margin:0 5px 5px 0;
		color:#fff;
		background:#000;
		border:none;
	}
	#result-body{
		position: relative;
	}
	.code-copy{
		position:absolute;
		right:5px;
		top:5px;
	}
	.title {
		background:#f5f5f5;
		padding-left:1em;
		padding-bottom:1em;
	}
	.title h2{
		display: inline;
		font-size:14px;
		margin-right:0.5em;
	}
</style>


<!-- 
check.jsæ˜¯åšä¸€äº›ç¯å¢ƒç›‘æµ‹ç”¨çš„ä¸´æ—¶ä»£ç ï¼Œä»…é™å¼€å‘è°ƒè¯•ä½¿ç”¨
-->
<!-- <script src="js/pre-check.js"></script> -->

<!-- 
http://www.ghostchina.com/adding-syntax-highlighting-to-ghost-using-highlight-js/
-->
<link href="res/monokai_sublime.min.css" rel="stylesheet">  
<script src="res/highlight.min.js"></script> 

<script type="text/javascript" src="lib/jquery-3.1.1.js"></script>
<link rel="stylesheet" href="json-view/jsonview.css" />
<script type="text/javascript" src="json-view/jquery.jsonview.js"></script>

<script src="//cdn.ronghub.com/RongIMLib-2.5.0.js"></script>
<script src="//cdn.ronghub.com/RongEmoji-2.2.4.min.js"></script> 
<script src="//cdn.ronghub.com/RongIMVoice-2.2.4.min.js"></script>

<!-- å£°éŸ³æ ·æœ¬æ–‡ä»¶ -->
<script src="res/voice-amr-base64.json"></script>

<!-- äºŒæ¬¡å°è£…çš„åˆå§‹åŒ–ä»£ç  -->
<script src="init.js"></script>

<script>
"use strict";
function showTips(data){
	var dom = document.getElementById("show");
		dom.style.display = "block";
	if(data){
		dom.innerHTML += "<li>" + data + "</li>";
	}else{
		dom.innerHTML = "";
	}
}	
function showResult(title,code,start){
	var dom = document.getElementById("result-area");
		dom.style.display = "block";

	var now = new Date().getTime();
	var t = document.getElementById("result-title");
		t.innerHTML = title + '  <small>æ‰§è¡Œæ—¶é—´ï¼š'  + (now - start) + 'ms</small>';
	
	jsonOprators(code);
}

function jsonOprators(json){
	var jt = $('#result-body');

	if(typeof json == 'function'){
		jt.html('<pre class="jsonview"><code id="result-code">' + json + '</code></pre>');
		$('pre > code').each(function(i, block) {
			hljs.highlightBlock(block);
		});
	}else{
		json = JSON.stringify(json);
		jt.JSONView(json);
	}

	$('#collapse-btn').on('click', function() {
		jt.JSONView('collapse');
	});

	$('#expand-btn').on('click', function() {
		jt.JSONView('expand');
	});

	$('#toggle-btn').on('click', function() {
		jt.JSONView('toggle');
	});

	$('#toggle-level1-btn').on('click', function() {
		jt.JSONView('toggle', 1);
	});

	$('#toggle-level2-btn').on('click', function() {
		jt.JSONView('toggle', 2);
	});
}


function getTimer(begin){
	var now = new Date().getTime();
	return " time:" + (now - begin) + " ms";
}
</script>

<!-- 
ç”¨æˆ·æ•°æ®ï¼Œç¾¤ç»„æ•°æ®ï¼Œå¥½å‹å…³ç³» å¿…é¡»æœ‰åº”ç”¨æœåŠ¡å™¨æä¾›
æ˜¾ç¤ºä¼šè¯ä¿¡æ¯éœ€è¦ä»èäº‘å’Œåº”ç”¨æœåŠ¡å™¨å…±åŒè·å–æ•°æ®æ‰èƒ½å®Œæ•´æ˜¾ç¤º



å¼€å‘ç¯å¢ƒ 
	é»˜è®¤appkey = 8w7jv4qb78a9yï¼Œå·²ä¸Šçº¿
	å½“å‰ç”¨æˆ·ï¼šuser8
	å¯¹è±¡ç”¨æˆ·ï¼šuser9,user10 

ç”Ÿäº§ç¯å¢ƒ
	82hegw5uh8ktx
	rybznHwVbrk7upeAMWv8RnHEDKuqy0jJayFPsQ4gP8z+SyAuRRg4uk2hA24NDcnvbl6oswAYXQCdpAbHm4pp9g==
-->
<script>
"use strict";
var instance = null;
var appKey = "";
var token = "";

var userId = "";

/*
æ¶ˆæ¯å…¨éƒ¨ç”¨å•èŠï¼Œuser8 -> user9
*/
var conversationType = RongIMLib.ConversationType.PRIVATE; // ç§èŠ
 /*
 PRIVATE 				1		å•èŠ
 DISCUSSION 			2		è®¨è®ºç»„
 GROUP 					3		ç¾¤ç»„
 CHATROOM 				4		èŠå¤©å®¤
 CUSTOMER_SERVICE 		5		å®¢æœ
 SYSTEM 				6		ç³»ç»Ÿæ¶ˆæ¯
 APP_PUBLIC_SERVICE 	7		åº”ç”¨å…¬ä¼—è´¦å·ï¼ˆåº”ç”¨å†…ç§æœ‰ï¼‰
 PUBLIC_SERVICE 		8		å…¬ä¼—è´¦å· (å…¬æœ‰)
 */

var targetId = "user9"; 
var targetId2 = "user10";
var targetIds = [];
//æ¶ˆæ¯æ¥æ”¶æ–¹ Idï¼Œæ ¹æ®ä¸åŒçš„ ConversationTypeï¼Œå¯èƒ½æ˜¯ç”¨æˆ· Idã€è®¨è®ºç»„ Idã€ç¾¤ç»„ Idã€èŠå¤©å®¤ Idç­‰ã€‚

var begin = 0;

function startInit(token){
	appKey = document.getElementById("appkey").value;

	if(appKey == ""){
		alert("å¿…é¡»æä¾›appkeyå’Œtoken");
	}

	showTips();

	begin = new Date().getTime()

	//å…¬æœ‰äº‘åˆå§‹åŒ–
	var config = {
		//protobuf: 'https://cdn.ronghub.com/protobuf-2.3.1.min.js' //æ”¯æŒhttp(s)ç½‘ç»œè·¯å¾„ã€æœ¬åœ°ç›¸å¯¹è·¯å¾„	
  };

    /*

		----------
		å¤‡æ³¨ï¼š æ¡Œé¢ç‰ˆéœ€ä¼˜å…ˆå¼€é€šï¼Œå¼€é€šåæ–¹å¯ä½¿ç”¨
					å¼€é€šæ–¹å¼ï¼Œè¯·ç§»æ­¥å¼€å‘è€…åå°æå·¥å•ï¼Œç”³è¯·å¼€é€š https://developer.rongcloud.cn/signin?returnUrl=%2F
		----------

		RongDesktop å³ä¸º electron-c++sdk/js/preload.js ä¸­çš„ `RongDesktop`
		ä»¥ä¸‹é€»è¾‘ä¸º RongDesktop å­˜åœ¨å³è®¤ä¸ºåœ¨ Electron ä¸­ï¼Œè¯·ä¸€å®šä¿è¯ RongDesktop å”¯ä¸€ã€ä¸å¯ç ´åã€ä¸è¢«æ±¡æŸ“
		è¯¦ç»†è¯·å‚è€ƒ init.js dataProvider ç”¨æ³•
    */
    var imClient = null;
	var isDesktopEnv = (typeof RongDesktop != 'undefined')
	if (isDesktopEnv) {
		imClient = RongDesktop.require('IMLib');
		// document.getElementById("rong-discussion").style.display = 'none';
		// document.getElementById("rong-public-service").style.display = 'none';
		// document.getElementById("rong-home-page").style.display = 'block';
	}

	var params = {
		appKey : appKey,
		token : token,
		imClient: imClient,
		userId: 'user10'
	};

	var callbacks = {
		getInstance : function(_instance){
			instance = _instance;
		},
		receiveNewMessage : function(message){
			// åˆ¤æ–­æ¶ˆæ¯ç±»å‹
		    showTips("æ–°æ¶ˆæ¯ï¼Œç±»å‹ä¸ºï¼š" + message.messageType);
            // showResult("æ–°æ¶ˆæ¯",message,start);

            console.log("messageUId:" + message.messageUId + ",   messageId:" + message.messageId);
            console.log(message);
		},
		getCurrentUser : function(userInfo){
			showTips("é“¾æ¥æˆåŠŸ ç”¨æˆ·idï¼š" + userInfo.userId + ", è€—æ—¶" + getTimer(begin));
			userId = userInfo.userId;
			document.getElementById("login").innerHTML = userId;
		    afterConnected();
		}
	};
	init(params,callbacks,config);
	showTips("åˆå§‹åŒ– åº”ç”¨ " + getTimer(begin));


	RongIMLib.RongIMEmoji.init();
	showTips("åˆå§‹åŒ– è¡¨æƒ…åº“ " + getTimer(begin));


	RongIMLib.RongIMVoice.init();
	showTips("åˆå§‹åŒ– å£°éŸ³åº“ " + getTimer(begin));
}

function login(){
	token = document.getElementById("token").value;

	if(token == ""){
		alert("å¿…é¡»æä¾› token");
	}

	targetIds = document.getElementById("targetId").value;
	if(targetIds == ""){
		alert("å¿…é¡»æä¾›ä¸¤ä¸ªçš„æœ‰æ•ˆtargetId");
	}

	targetIds = targetIds.split("ï¼Œ").join(",").split(",");
	targetId = targetIds[0];	
	targetId2 = targetIds[1];

	startInit(token);	
}

function changeUser(){
	instance.logout();
	var token = document.getElementById("token2").value;

	if(token == ""){
		alert("å¿…é¡»æä¾› token");
	}
	startInit(token);
}

function afterConnected(){
	document.getElementById("panel").style.display = "none";
	document.getElementById("btns").style.display = "block";
}

function disconnect(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/RongIMClient.html
	*/

	var start = new Date().getTime();
	instance.disconnect();
	showResult("æ–­å¼€é“¾æ¥ æˆåŠŸ", null , start);
}

function reconnect(){
	/*
	1: reconnect æ˜¯é‡æ–°è¿æ¥ï¼Œå¹¶æ²¡æœ‰é‡è¿æœºåˆ¶ï¼Œè°ƒç”¨æ­¤æ–¹æ³•å‰åº”è¯¥è¿›è¡Œç½‘ç»œå—…æ¢ï¼Œç½‘ç»œæ­£å¸¸å†è°ƒç”¨ reconnectã€‚
	2: æç¤ºå…¶ä»–è®¾å¤‡ç™»å½•è¯·å‹¿è°ƒç”¨é‡è¿æ–¹æ³•ã€‚
 	3: docs   http://www.rongcloud.cn/docs/api/js/RongIMClient.html
	*/

 	var start = new Date().getTime();
	begin = new Date().getTime();
	RongIMClient.reconnect({
		onSuccess: function(userId) {
			showTips("é‡æ–°é“¾æ¥æˆåŠŸï¼Œç”¨æˆ·idï¼š" + userId + "; " + getTimer(begin));
			showResult("é‡æ–°é“¾æ¥ æˆåŠŸ", userId, start);
		},
		onTokenIncorrect: function() {
			//console.log('tokenæ— æ•ˆ');
			showResult("é‡æ–°é“¾æ¥ å¤±è´¥", "tokenæ— æ•ˆ", start);
		},
		onError:function(errorCode){
		  var info = '';
		  switch (errorCode) {
		    case RongIMLib.ErrorCode.TIMEOUT:
		      info = 'è¶…æ—¶';
		      break;
		    case RongIMLib.ErrorCode.UNKNOWN_ERROR:
		      info = 'æœªçŸ¥é”™è¯¯';
		      break;
		    case RongIMLib.ErrorCode.UNACCEPTABLE_PROTOCOL_VERSION:
		      info = 'ä¸å¯æ¥å—çš„åè®®ç‰ˆæœ¬';
		      break;
		    case RongIMLib.ErrorCode.IDENTIFIER_REJECTED:
		      info = 'appkeyä¸æ­£ç¡®';
		      break;
		    case RongIMLib.ErrorCode.SERVER_UNAVAILABLE:
		      info = 'æœåŠ¡å™¨ä¸å¯ç”¨';
		      break;
		  }
		  showTips(info);
		  showResult("é‡æ–°é“¾æ¥ å¤±è´¥", info, start);
		}
	});
}

//æ¶ˆæ¯æ’¤å›å˜é‡åŠè®¾ç½®
var recallMessage = null, clearMessage;
function markMessage(message){
	recallMessage = message;
	clearMessage = message;
}

function sendTextMessage(){
	/*
	æ–‡æ¡£ï¼š http://www.rongcloud.cn/docs/web.html#5_1ã€å‘é€æ¶ˆæ¯
		   http://rongcloud.cn/docs/api/js/TextMessage.html
	1: å•æ¡æ¶ˆæ¯æ•´ä½“ä¸å¾—å¤§äº128K
	2: conversatinType ç±»å‹æ˜¯ numberï¼ŒtargetId ç±»å‹æ˜¯ string
	*/

	/*
		1ã€ä¸è¦å¤šç«¯ç™»é™†ï¼Œä¿è¯æ‰€æœ‰ç«¯éƒ½ç¦»çº¿
		2ã€æ¥æ”¶ push è®¾å¤‡è®¾ç½®:
			ï¼ˆ1ï¼‰æ‰“å¼€ç³»ç»Ÿé€šçŸ¥æé†’
			ï¼ˆ2ï¼‰å°ç±³è®¾ç½® â€œæˆæƒç®¡ç†â€ ï¼> â€œè‡ªå·±çš„åº”ç”¨â€ ä¸ºè‡ªå¯åŠ¨
			ï¼ˆ3ï¼‰åº”ç”¨å†…ä¸è¦å±è”½æ–°æ¶ˆæ¯é€šçŸ¥
		3ã€å†…ç½®æ¶ˆæ¯ç±»å‹ï¼Œé»˜è®¤ pushï¼Œè‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹éœ€è¦
		   pushData æ˜¾ç¤ºé€»è¾‘é¡ºåºï¼šè‡ªå®šä¹‰ > é»˜è®¤
		4ã€å‘é€å…¶ä»–æ¶ˆæ¯ç±»å‹ä¸å‘é€ TextMessage é€»è¾‘ã€æ–¹å¼ä¸€è‡´
	*/
	var pushData = "pushData" + Date.now();

	var isMentioned = false;

	var content = {
		content: [
			"é˜¿æ‹‰ä¼¯è¯­ï¼šØ§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø· ",
			"å¸Œä¼¯æ¥è¯­ï¼š×”××–×¨×— ×”×ª×™×›×•×Ÿ",
			"emoji: ğŸ˜Š ",
			"å¸Œè…Šå­—æ¯ï¼š Ï€ï¼ŒÎ±ï¼ŒÎ², ",
			"æ•°å­—å•ä½éƒ¨åˆ†å­—ç¬¦ å¦‚ï¼šÃ— ",
			"æ‹‰ä¸æ–‡æ‰€æœ‰å­—ç¬¦ å¦‚ï¼šÎŸ Î¡ Ïƒ Ã Ã† ",
			"æ‹¼éŸ³æ‰€æœ‰å­—ç¬¦ å¦‚ï¼š Ä› Ã¬ Åˆ ",
			"è‹±æ–‡éŸ³æ ‡éƒ¨åˆ†å­—ç¬¦ å¦‚ ï¼š É™ Êƒ ",
			"ä¿„æ–‡éƒ¨åˆ†å­—ç¬¦ å¦‚ ï¼šÑˆ ; âŠ‡ Ã¢ Å’ Å  â„¢ "
		].join(","),
		user : {
			"id" : "this-is-a-test-id",	//ä¸æ”¯æŒä¸­æ–‡åŠç‰¹æ®Šå­—ç¬¦
			"name" : "å¼ ä¸‰",
			"portrait" : "https://avatars1.githubusercontent.com/u/10265829?s=96&v=4"
		},
		extra: "{\"key\":\"value\", \"key2\" : 12, \"key3\":true}"
	};

	var msg = new RongIMLib.TextMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
        onSuccess: function (message) {
        	markMessage(message);
            showResult("å‘é€æ–‡å­—æ¶ˆæ¯ æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€æ–‡å­—æ¶ˆæ¯ å¤±è´¥",message,start);
        }
    }, isMentioned, pushData);
}

function sendImageMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/ImageMessage.html

	éœ€è‡ªè¡Œè§£å†³æ–‡ä»¶ä¸Šä¼ 
	ä¸Šä¼ æ’ä»¶ï¼ˆå«è·å–ç¼©ç•¥å›¾æ–¹æ³•ï¼‰: https://github.com/rongcloud/rongcloud-web-im-upload
	
	ç¼©ç•¥å›¾å¿…é¡»æ˜¯base64ç çš„jpgå›¾ï¼Œè€Œä¸”ä¸å¸¦å‰ç¼€"data:image/jpeg;base64,"ï¼Œä¸å¾—è¶…è¿‡100K
	å‹ç¼©ï¼šhttps://github.com/rongcloud/rongcloud-web-im-upload/blob/master/resize.html
	*/

	var content = {
		imageUri: "http://rongcloud.cn/images/newVersion/log_wx.png", 
		content: getBase64Image()
	};

	var msg = new RongIMLib.ImageMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
        onSuccess: function (message) {
        	markMessage(message);
            showResult("å‘é€å›¾ç‰‡æ¶ˆæ¯ æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€å›¾ç‰‡æ¶ˆæ¯ å¤±è´¥",message,start);
        }
    });	
}

function sendFileMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/ImageMessage.html

	uploadç»„ä»¶ï¼šhttps://github.com/rongcloud/rongcloud-web-im-upload
	ä¸Šä¼ æ’ä»¶æ–‡æ¡£: http://rongcloud.cn/docs/web.html#ä¸Šä¼ æ’ä»¶

	å•æ¡æ¶ˆæ¯æ•´ä½“ä¸å¾—å¤§äº128K

	æ–‡ä»¶æ¶ˆæ¯åˆ†ä¸¤æ­¥ï¼š
		1ã€ä¸Šä¼ æ–‡ä»¶è‡³æ–‡ä»¶æœåŠ¡å™¨
		2ã€å‘é€æ–‡ä»¶ä¿¡æ¯å’Œæ–‡ä»¶ URL
	*/

	var content = {
	    name: 'log_wx', // æ–‡ä»¶åç§°
	    size: '20k', // æ–‡ä»¶å¤§å°ï¼Œå•ä½è‡ªå·±çº¦å®š
	    type: 'png', // æ–‡ä»¶çš„åç¼€åï¼Œä¾‹å¦‚ pngã€jsã€doc ...
	    fileUrl: 'http://rongcloud.cn/images/newVersion/log_wx.png' // æ–‡ä»¶åœ°å€
	};

	var msg = new RongIMLib.FileMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
        onSuccess: function (message) {
        	markMessage(message);
            showResult("å‘é€æ–‡ä»¶æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€æ–‡ä»¶æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });	
}

function sendVoiceMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/VoiceMessage.html

	éœ€è‡ªè¡Œè§£å†³å½•éŸ³å’Œè½¬ç é—®é¢˜ï¼Œè¦æ±‚ç¼–ç ä¸ºbase64æ ¼å¼amrï¼Œä¸å¸¦å‰ç¼€ï¼Œä¸å¾—è¶…è¿‡100K

	å£°éŸ³æ’­æ”¾ï¼šhttps://rongcloud.github.io/websdk-demo/voice.html
	*/
	var content = {
		content : voice, //form res/voice-amr-base64.json
		duration : 20
	};
	
	var msg = new RongIMLib.VoiceMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
        onSuccess: function (message) {
        	markMessage(message);
            showResult("å‘é€è¯­éŸ³æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€è¯­éŸ³æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });
}

function sendAtMessage(){
    /*
    @ æ¶ˆæ¯å¯¹è±¡
    å…¨éƒ¨ï¼šRongIMLib.MentionedType.ALLï¼›
    éƒ¨åˆ†ï¼šRongIMLib.MentionedType.PART
	
	æ–‡æ¡£è¯´æ˜ï¼šhttp://support.rongcloud.cn/kb/NjE1
    æ¥æ”¶@ä»£ç ï¼šhttps://rongcloud.github.io/websdk-demo/connect-check.html
    */
    var mentioneds = new RongIMLib.MentionedInfo();
	    mentioneds.type = RongIMLib.MentionedType.PART;
    	mentioneds.userIdList = [targetId, targetId2];

    var content = {
    	content: "This is a at message!",
    	extra: "extra info",
    	mentionedInfo: mentioneds
    };
	var msg = new RongIMLib.TextMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
		onSuccess: function (message) {
		   //message ä¸ºå‘é€çš„æ¶ˆæ¯å¯¹è±¡å¹¶ä¸”åŒ…å«æœåŠ¡å™¨è¿”å›çš„æ¶ˆæ¯å”¯ä¸€Idå’Œå‘é€æ¶ˆæ¯æ—¶é—´æˆ³
            showResult("å‘é€ @ æ¶ˆæ¯æˆåŠŸ",message,start);
		},
		onError: function (errorCode,message) {
            showResult("å‘é€ @ æ¶ˆæ¯å¤±è´¥",message,start);
        }
	}, true);
}

function registerMessage(type,propertys){
	var messageName = type; // æ¶ˆæ¯åç§°ã€‚
	var objectName = "s:" + type; // æ¶ˆæ¯å†…ç½®åç§°ï¼Œè¯·æŒ‰ç…§æ­¤æ ¼å¼å‘½å *:* ã€‚
	var mesasgeTag = new RongIMLib.MessageTag(true,true); //true true ä¿å­˜ä¸”è®¡æ•°ï¼Œfalse false ä¸ä¿å­˜ä¸è®¡æ•°ã€‚

	RongIMClient.registerMessageType(messageName,objectName,mesasgeTag,propertys);
}
function sendRegisterMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/web_api_demo.html#è‡ªå®šä¹‰æ¶ˆæ¯

	æ³¨æ„äº‹é¡¹ï¼š
		1ï¼šinitä¹‹å‰æ³¨å†Œæ–°æ¶ˆæ¯ç±»å‹
		2ï¼šå¯¹åº”æ¥æ”¶ onReceived: function (message) {}
			message.messageType == "PersonMessage"
		3ï¼šéœ€è¦è‡ªå·±åšè§£æå®ç°
	*/
	var propertys = ["name","age","gender"]; // æ¶ˆæ¯ç±»ä¸­çš„å±æ€§åã€‚
	registerMessage("PersonMessage",propertys);

	var content = {
		name: {
			"first" : "Bob",
			"last" : "Smith"
		},
		age: 3,
		gender: "male"
	};

	var msg = new RongIMClient.RegisterMessage.PersonMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
        onSuccess: function (message) {
        	markMessage(message);
            showResult("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });
}

function sendLocationMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/LocationMessage.html

	ç¼©ç•¥å›¾å¿…é¡»æ˜¯base64ç çš„jpgå›¾ï¼Œè€Œä¸”ä¸å¸¦å‰ç¼€"data:image/jpeg;base64,"ï¼Œä¸å¾—è¶…è¿‡100K

	éœ€è¦è‡ªå·±åšæ˜¾ç¤ºæ•ˆæœï¼Œä¸€èˆ¬æ˜¾ç¤ºé€»è¾‘ï¼šå›¾ç‰‡åŠ é“¾æ¥ï¼Œä¼ å…¥ç»çº¬åº¦å¹¶è·³è½¬è¿›å…¥åœ°å›¾ç½‘ç«™
	*/

	var content = {
		"content":getBase64Image(),
		"latitude":"24.114",
		"longitude":"334.221",
		"poi":"åŒ—äº¬å¸‚æœé˜³åŒºåŒ—è‹‘è·¯åŒ—è¾°æ³°å²³å¤§å¦"
	};

	var msg = new RongIMLib.LocationMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
        onSuccess: function (message) {
        	markMessage(message);
            showResult("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€è‡ªå®šä¹‰æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });
}

function sendRichContentMessage(){
	/*
	http://www.rongcloud.cn/docs/api/js/RichContentMessage.html
	*/ 

	var content = {
		"title": "sendRichContentMessage",
		"content": "<a href=\"http://www.rongcloud.cn\">hello</a>",
		"imageUri": "http://www.demo.com/1.jpg",
		"url": "http://www.rongcloud.cn/",
		"extra": "{\"key\":\"value\"}"
	};

	var msg = new RongIMLib.RichContentMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
        onSuccess: function (message) {
        	markMessage(message);
            showResult("å‘é€å›¾æ–‡æ¶ˆæ¯æˆåŠŸ", message, start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€å›¾æ–‡æ¶ˆæ¯å¤±è´¥", message, start);
        }
    });
}

function SendSyncReadStatusMessage(){
	/*
	ä¸€ç«¯å‘é€ï¼Œå…¶ä»–ç«¯æ¥å—å¹¶åšåŒæ­¥æ›´æ–°
	å…·ä½“å¤„ç†è¯´æ˜æ–‡æ¡£ï¼š http://support.rongcloud.cn/kb/NjE0
	*/ 
	var sentTime = 1486975569605;// message çš„ sentTime æœåŠ¡å™¨ç«¯æ—¶é—´
	var content = {
		lastMessageSendTime: sentTime
	};
	var msg = new RongIMLib.SyncReadStatusMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, targetId, msg, {
        onSuccess: function (message) {
            showResult("å‘é€åŒæ­¥æ¶ˆæ¯æˆåŠŸ", message, start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€åŒæ­¥æ¶ˆæ¯å¤±è´¥", message, start);
        }
    });	
}

function sendRecallMessage(){
	if(recallMessage == null){
		alert("è¯·å…ˆå‘é€ä»»æ„ä¸€æ¡æ¶ˆæ¯ä¼šå†æ‰§è¡Œæ’¤å›");
		return;
	}
	//æ¶ˆæ¯æ’¤å›æœåŠ¡å™¨ç«¯æ²¡æœ‰æ—¶é—´é™åˆ¶ï¼Œç”±å®¢æˆ·ç«¯å†³å®š

	var start = new Date().getTime();
	instance.sendRecallMessage(recallMessage, {
        onSuccess: function (message) {
            showResult("æ’¤å›æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("æ’¤å›å¤±è´¥",message,start);
        }
    });		
}

function checkUnreadMessage(){
	/*
	http://www.rongcloud.cn/docs/web.html#5_5ã€æ£€æµ‹æ˜¯å¦æœ‰æœªè¯»çš„æ¶ˆæ¯

	æ­¤æ¥å£å¿…é¡»åœ¨init()æ–¹æ³•ä¹‹åè°ƒç”¨ï¼Œä½†ä¸ä¾èµ–äºconnect
	åªè¿”å›true/falseï¼Œä¸è¿”å›å…·ä½“çš„æœªè¯»æ•°é‡
	è‹¥è¿æ¥æˆåŠŸåè°ƒç”¨æ­¤æ–¹æ³•å°†ä¸€ç›´è¿”å› falseã€‚
	*/
	
	var start = new Date().getTime();
	instance.hasRemoteUnreadMessages(token,{
	    onSuccess:function(hasMessage){
	        if(hasMessage){
	            // æœ‰æœªè¯»çš„æ¶ˆæ¯
	        }else{
	            // æ²¡æœ‰æœªè¯»çš„æ¶ˆæ¯
	        }

            showResult("æ£€æŸ¥æœªè¯»æ¶ˆæ¯æˆåŠŸ",hasMessage,start);

	    },onError:function(err){
            showResult("æ£€æŸ¥æœªè¯»æ¶ˆæ¯å¤±è´¥",err,start);
	    }
	});
}

function getHistroyMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/web_api_demo.html#è·å–å†å²æ¶ˆæ¯

	æ³¨æ„äº‹é¡¹ï¼š
		1ï¼šä¸€å®šä¸€å®šä¸€å®šè¦å…ˆå¼€é€š å†å²æ¶ˆæ¯äº‘å­˜å‚¨ åŠŸèƒ½ï¼Œæœ¬æœåŠ¡æ”¶è´¹ï¼Œæµ‹è¯•ç¯å¢ƒå¯å…è´¹å¼€é€š
		2ï¼šç™»å½•å¼€å‘è€…åå°å¯ä»¥ç›´æ¥å¼€å¯ https://developer.rongcloud.cn/app
		2ï¼štimestrapç¬¬äºŒæ¬¡æ‹‰å–å¿…é¡»ä¸ºnullæ‰èƒ½å®ç°å¾ªç¯æ‹‰å–
	*/

	var count = 3;  // 2 <= count <= 20
	var timestrap = null; //0, 1483950413013

	var start = new Date().getTime();
	instance.getHistoryMessages(conversationType, targetId, timestrap, count, {
		onSuccess: function(list, hasMsg) {
			//å¯é€šè¿‡sortè®¢åˆ¶å…¶ä»–é¡ºåº
			list.sort(function(a,b){
				return a.sentTime < b.sentTime;
			});

            showResult("è·å–å†å²æ¶ˆæ¯æˆåŠŸ",list,start);
		},
		onError: function(error) {
            showResult("è·å–å†å²æ¶ˆæ¯å¤±è´¥",error,start);
		}
	});
} 


function clearHistroyMessage(){
	/*
		æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/web_api_demo.html#ä¼šè¯æ¥å£

		æ³¨æ„äº‹é¡¹ï¼šå¿…é¡»å¼€é€šå†å²æ¶ˆæ¯äº‘å­˜å‚¨

		å‚æ•°è¯´æ˜ï¼š
		timestamp å–å€¼èŒƒå›´:  timestamp >=0 å¹¶ä¸” timestamp <= å½“å‰ä¼šè¯æœ€åä¸€æ¡æ¶ˆæ¯çš„ sentTime
 	*/
	if (!clearMessage) {
		alert('è¯·å…ˆå‘ä¸€æ¡æ¶ˆæ¯');
		return;
	}
	var start = new Date().getTime();
	var params = {
		conversationType: clearMessage.conversationType,
		targetId: clearMessage.targetId,
		timestamp: clearMessage.sentTime
	};
	instance.clearRemoteHistoryMessages(params, {
		onSuccess: function() {
            showResult("æ¸…é™¤å†å²æ¶ˆæ¯æˆåŠŸ", "success");
		},
		onError: function(error) {
			console.log('è¯·æ’æŸ¥ï¼š å†å²æ¶ˆæ¯äº‘å­˜å‚¨æ˜¯å¦å¼€é€š');
            showResult("æ¸…é™¤å†å²æ¶ˆæ¯å¤±è´¥",error);
		}
	});
} 

function getConversationList(){	
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/web_api_demo.html#ä¼šè¯æ¥å£
		http://www.rongcloud.cn/docs/web.html#5_2ã€åŒæ­¥ä¼šè¯åˆ—è¡¨
		http://www.rongcloud.cn/docs/api/js/Conversation.html

	å†å²æ¶ˆæ¯äº‘å­˜å‚¨å¼€é€šä½ç½®ï¼šhttps://developer.rongcloud.cn/service/roam/rXxI4IAJjxRAD72SpQ==

	æ³¨æ„äº‹é¡¹ï¼š
		1ï¼šä¸€å®šä¸€å®šä¸€å®šè¦å…ˆå¼€é€š å†å²æ¶ˆæ¯äº‘å­˜å‚¨ åŠŸèƒ½ï¼Œæœ¬æœåŠ¡æ”¶è´¹ï¼Œæµ‹è¯•ç¯å¢ƒå¯å…è´¹å¼€é€š
		2ï¼šåªæœ‰å‘è¿‡æ¶ˆæ¯æ‰èƒ½ç”Ÿæˆä¼šè¯
	*/

	var conversationTypes = null;  //å…·ä½“æ ¼å¼è®¾ç½®éœ€è¦è¡¥å……
	var limit = 150; //è·å–ä¼šè¯çš„æ•°é‡ï¼Œä¸ä¼ æˆ–ä¼ nullä¸ºå…¨éƒ¨ï¼Œæš‚ä¸æ”¯æŒåˆ†é¡µ
	var start = new Date().getTime();
	instance.getConversationList({
		onSuccess: function(list) {
			// list.sort(function(a,b){
			// 	return a.sentTime > b.sentTime;
			// });

			var title = "æˆåŠŸè·å– " + list.length + " ä¸ªä¼šè¯";
            showResult(title,list,start);
		},
		onError: function(error) {
            showResult("è·å–ä¼šè¯å¤±è´¥",error,start);
		}
    }, conversationTypes, limit);
}

function getConversation(){
	//éœ€åœ¨ getConversationList æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼Œå¦åˆ™è¿”å›null
	var start = new Date().getTime();

	instance.getConversation(conversationType, targetId, { 
		onSuccess:function(result){ 
            showResult("è·å–ç¾¤ç»„ä¼šè¯ æˆåŠŸ", result, start);
		}, 
		onError:function(error){ 
		    showResult("è·å–ç¾¤ç»„ä¼šè¯ å¤±è´¥", error, start);
		} 
	});
}

function removeConversation(){
	var start = new Date().getTime();
	instance.removeConversation(conversationType, targetId, { 
		onSuccess:function(result){ 
            showResult("åˆ é™¤ä¼šè¯æˆåŠŸ",result,start);
		}, 
		onError:function(error){ 
		// error => æ¸…é™¤ä¼šè¯é”™è¯¯ç ã€‚ 
		    showResult("åˆ é™¤ä¼šè¯å¤±è´¥",error,start);
		} 
	});
}

function clearConversation(){
	var start = new Date().getTime();
	instance.clearConversations({ 
		onSuccess:function(){ 
            showResult("æ¸…é™¤ä¼šè¯æˆåŠŸ",null,start);
		}, 
		onError:function(error){ 
		// error => æ¸…é™¤ä¼šè¯é”™è¯¯ç ã€‚ 
		    showResult("æ¸…é™¤ä¼šè¯å¤±è´¥",error,start);
		} 
	});
}

function getUnreadCount(){
	/*
		é˜…è¯»æ—¶é—´æˆ³ç¼“å­˜åœ¨ localStorage ä¸­ï¼Œæ¶ˆæ¯çŠ¶æ€æ ¹æ®å‘é€æ—¶é—´å’Œé˜…è¯»æ—¶é—´æˆ³å¯¹æ¯”åˆ¤æ–­
		æ¯æ¬¡æ¥å—æ–°æ¶ˆæ¯åé€šè¿‡é‡æ–°è°ƒç”¨æ­¤æ–¹æ³•è®¡ç®—
	 */
	var start = new Date().getTime();
	instance.getUnreadCount(conversationType,targetId,{
	    onSuccess:function(count){
	       showResult("è·å–ä¼šè¯æœªè¯»æ•°æˆåŠŸ", count, start);
	    },
	    onError:function(error){
	       showResult("è·å–ä¼šè¯æœªè¯»æ•°å¤±è´¥", error, start);
	    }
	});
}

function getTotalUnreadCount(){
	/*
		é˜…è¯»æ—¶é—´æˆ³ç¼“å­˜åœ¨ localStorage ä¸­ï¼Œæ¶ˆæ¯çŠ¶æ€æ ¹æ®å‘é€æ—¶é—´å’Œé˜…è¯»æ—¶é—´æˆ³å¯¹æ¯”åˆ¤æ–­
		æ¯æ¬¡æ¥å—æ–°æ¶ˆæ¯åé€šè¿‡é‡æ–°è°ƒç”¨æ­¤æ–¹æ³•è®¡ç®—
	 */
	var start = new Date().getTime();
	instance.getTotalUnreadCount({
	  onSuccess:function(count){
	       showResult("è·å–æ€»æœªè¯»æ•°æˆåŠŸ", count, start);
	  },
	  onError:function(error){
	      showResult("è·å–æ€»æœªè¯»æ•°å¤±è´¥", error, start);
	  }
	});
}

function clearTotalUnreadCount(){
	var start = Date.now();
	instance.clearTotalUnreadCount({
	    onSuccess:function(){
	        showResult("æ¸…é™¤æœªè¯»æ€»æ•°æˆåŠŸ", "success", start);
	    },
	    onError:function(error){
	        showResult("æ¸…é™¤æœªè¯»æ€»æ•°å¤±è´¥", error, start);
	    }
	});
}
function clearUnreadCount(){
	/*
	 	æ­¤æ–¹æ³•æ¸…é™¤å½“å‰ç«¯çš„æœªè¯»æ•°ï¼Œå¹¶ä¸ä¼šå¤šç«¯åŒæ­¥ï¼Œ
	 	å¤šç«¯åŒæ­¥éœ€è¦å‘é€ SyncReadStatusMessageï¼šhttp://support.rongcloud.cn/kb/NjE0
	 */

	var start = Date.now();
	instance.clearUnreadCount(conversationType,targetId,{
	    onSuccess:function(){
	        showResult("æ¸…é™¤æŒ‡å®šä¼šè¯æœªè¯»æ•°æˆåŠŸ", "success", start);
	    },
	    onError:function(error){
	        showResult("æ¸…é™¤æŒ‡å®šä¼šè¯æœªè¯»æ•°å¤±è´¥", error, start);
	    }
	});
}


function receiveMessage(){
	alert("è¯·è§initæ–¹æ³•é‡Œçš„ RongIMClient.setOnReceiveMessageListener")
}


//åŠ å…¥èŠå¤©å®¤åï¼Œå¯ä»¥ç”¨ä»»æ„ä¸€ä¸ªå‘é€æ¶ˆæ¯çš„æ–¹æ³•å‘é€æ¶ˆæ¯ï¼Œåªéœ€è¦conversationTypeä¸ºCHATROOM
var chatRoomId = "chatRoomId-008"; // èŠå¤©å®¤ Id,å¯ä»»æ„æŒ‡å®šï¼Œèƒ½åŒºåˆ†ä¸åŒèŠå¤©å®¤å³å¯
var count = 10; //æ‹‰å–æœ€è¿‘çš„ä¼šè¯å†…å®¹ï¼ˆæœ€å¤š50æ¡ï¼‰ï¼Œ-1ä¸æ‹‰å– 

function enterChatroom(){
	/*
	http://www.rongcloud.cn/docs/web_api_demo.html#èŠå¤©å®¤

	èŠå¤©å®¤ä¸æ”¯æŒé€šè¿‡ getHistoryMessages æ–¹æ³•è·å–å†å²æ¶ˆæ¯ï¼Œ

	countï¼š//æ‹‰å–æœ€è¿‘çš„ä¼šè¯å†…å®¹ï¼ˆæœ€å¤š50æ¡ï¼‰ï¼Œ-1ä¸æ‹‰å– 
	*/

	var start = new Date().getTime();
	instance.joinChatRoom(chatRoomId, count, {
		onSuccess: function() {
            showResult("åŠ å…¥èŠå¤©å®¤æˆåŠŸ",null,start);
		},
		onError: function(error) {
            showResult("åŠ å…¥èŠå¤©å®¤å¤±è´¥",null,start);
		}
	});
}

function quitChatroom(){
	var start = new Date().getTime();
	instance.quitChatRoom(chatRoomId, {
		onSuccess: function() {
            showResult("é€€å‡ºèŠå¤©å®¤æˆåŠŸ",null,start);
		},
		onError: function(error) {
            showResult("é€€å‡ºèŠå¤©å®¤å¤±è´¥",null,start);
		}
	});
}

function getChatroomInfo(){
	/*
	éœ€ç¡®è®¤ å½“å‰ç”¨æˆ· å·²åŠ å…¥èŠå¤©å®¤
	*/ 
	var order = RongIMLib.GetChatRoomType.REVERSE;// æ’åºæ–¹å¼ã€‚
	var memberCount = 10; // è·å–èŠå¤©å®¤äººæ•° ï¼ˆèŒƒå›´ 0-20 ï¼‰

	var start = new Date().getTime();
	instance.getChatRoomInfo(chatRoomId, memberCount, order, {
	  onSuccess: function(chatRoom) {
			// chatRoom => èŠå¤©å®¤ä¿¡æ¯ã€‚
			// chatRoom.userInfos => è¿”å›èŠå¤©å®¤æˆå‘˜ã€‚
			// chatRoom.userTotalNums => å½“å‰èŠå¤©å®¤æ€»äººæ•°ã€‚
            showResult("è·å–èŠå¤©å®¤ä¿¡æ¯æˆåŠŸ",chatRoom,start);
	  },
	  onError: function(error) {
            showResult("è·å–å¤©å®¤ä¿¡æ¯å¤±è´¥",error);
	  }
	});
}

function sendMessageToChatroom(){
	var content = {
		content:"helloï¼Œtimeï¼š" + new Date().getTime(),
		extra:"RongCloud"
	};

	var conversationType = RongIMLib.ConversationType.CHATROOM; // ç§èŠ
	var msg = new RongIMLib.TextMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(conversationType, chatRoomId, msg, {
        onSuccess: function (message) {
            showResult("å‘é€èŠå¤©å®¤æ¶ˆæ¯æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€èŠå¤©å®¤æ¶ˆæ¯å¤±è´¥",message,start);
        }
    });
}

//å‘é€é¢˜ç›®
function sendQAMessage(){
	/*
	æ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/web_api_demo.html#è‡ªå®šä¹‰æ¶ˆæ¯

	æ³¨æ„äº‹é¡¹ï¼š
		1ï¼šinitä¹‹å‰æ³¨å†Œæ–°æ¶ˆæ¯ç±»å‹
		2ï¼šå¯¹åº”æ¥æ”¶ onReceived: function (message) {}
			message.messageType == "PersonMessage"
		3ï¼šéœ€è¦è‡ªå·±åšè§£æå®ç°
	*/
	var propertys = ["title","submitAPI","questions"]; // æ¶ˆæ¯ç±»ä¸­çš„å±æ€§åã€‚
	registerMessage("QA",propertys);

	var questions = [
		{
			id: 8560,
			question : "ä¸­å›½é¦–éƒ½æ˜¯é‚£ä¸ªåŸå¸‚ï¼Ÿ",
			answers : [{ id: 9901,answer: 'ä¸Šæµ·', bingo: 9904},
					   { id: 9903,answer: 'æ­¦æ±‰', bingo: 9904 },
					   { id: 9904,answer: 'åŒ—äº¬', bingo: 9904 },
					   { id: 9905,answer: 'æ·±åœ³', bingo: 9904 }]
		},
		{
			id: 8561,
			question : "ä¸–ç•Œä¸Šæœ€å¤§çš„å²›æ˜¯é‚£ä¸ªï¼Ÿ",
			answers : [{ id: 9906,answer: 'é©¬è¾¾åŠ æ–¯åŠ ', bingo: 9909},
					   { id: 9907,answer: 'æµ·å—', bingo: 9909 },
					   { id: 9908,answer: 'å°æ¹¾', bingo: 9909 },
					   { id: 9909,answer: 'æ ¼é™µå…°', bingo: 9909 }]
		},
		{
			id: 8562,
			question : "å†°ä¸ç«ä¹‹æ­Œé‡Œï¼Œé‚£ä¸ªå®¶æ—çš„å¾½ç« æ˜¯ç‹¼ï¼Ÿ",
			answers : [{ id: 9910,answer: 'å²å¡”å…‹', bingo: 9910  },
					   { id: 9911,answer: 'å¡”æ ¼åˆ©å®‰', bingo: 9910 },
					   { id: 9912,answer: 'å…°å°¼æ–¯ç‰¹', bingo: 9910 }]
		},
		{
			id: 8563,
			question : "åœ°çƒä¸Šæœ€å¤§çš„å“ºä¹³åŠ¨ç‰©æ˜¯ï¼Ÿ",
			answers : [{ id: 9913,answer: 'é²¸é±¼', bingo: 9913 },
					   { id: 9914,answer: 'å¤§è±¡', bingo: 9913 },
					   { id: 9915,answer: 'å·¨èŸ’', bingo: 9913 },
					   { id: 9916,answer: 'æé¾™', bingo: 9913 }]
		},
		{
			id: 8564,
			question : "äººä»¬å¸¸è¯´çš„èŠ±å­£æ˜¯å‡ å²ï¼Ÿ",
			answers : [{ id: 9917,answer: 15, bingo: 9920 },
					   { id: 9918,answer: 20, bingo: 9920 },
					   { id: 9919,answer: 18, bingo: 9920 },
					   { id: 9920,answer: 16, bingo: 9920 }]
		},
		{
			id: 8565,
			question : "æˆé¾™ã€æ—å¿—é¢–ã€éƒ­å¾·çº²æœ€å¹´è½»çš„æ˜¯è°ï¼Ÿ",
			answers : [{ id: 9921,answer: 'æˆé¾™' , bingo: 9921},
					   { id: 9922,answer: 'æ—å¿—é¢–', bingo: 9921 },
					   { id: 9923,answer: 'éƒ­å¾·çº²', bingo: 9921 }]
		},
		{
			id: 8565,
			question : "åŠ³åŠ¨æ³•è§„å®šï¼ŒåŠ³åŠ¨è€…è¯•ç”¨æœŸä¸èƒ½è¶…è¿‡å‡ ä¸ªæœˆï¼Ÿ",
			answers : [{ id: 9921,answer: 3 , bingo: 9921},
					   { id: 9922,answer: 6, bingo: 9921 },
					   { id: 9923,answer: 9, bingo: 9921 },
					   { id: 9924,answer: 12, bingo: 9921 }]
		},
		{
			id: 8566,
			question : "èäº‘æˆç«‹å‡ å¹´äº†ï¼Ÿ",
			answers : [{ id: 9921,answer: 4 , bingo: 9921},
					   { id: 9922,answer: 5, bingo: 9921 },
					   { id: 9923,answer: 3, bingo: 9921 },
					   { id: 9924,answer: 2, bingo: 9921 }]
		},
		{
			id: 8567,
			question : "å˜è„¸æ˜¯æˆ‘å›½å“ªä¸ªæˆå‰§çš„ç»æ´»ï¼Ÿ",
			answers : [{ id: 9921,answer: 'å·å‰§' , bingo: 9921},
					   { id: 9922,answer: 'äº¬å‰§', bingo: 9921 },
					   { id: 9923,answer: 'è±«å‰§', bingo: 9921 },
					   { id: 9924,answer: 'è¯„å‰§', bingo: 9921 }]
		}
	];

	var qIndex = Math.floor(Math.random()*5);

	var content = {
		title: "å†²é¡¶å¤§ä¼š",
		submitAPI: "http://abc.com/check",
		questions: JSON.stringify([questions[qIndex]])
	};

	var msg = new RongIMClient.RegisterMessage.QA(content);

	var start = new Date().getTime();
	var conversationType = RongIMLib.ConversationType.CHATROOM; // ç§èŠ
	instance.sendMessage(conversationType, chatRoomId, msg, {
        onSuccess: function (message) {
        	markMessage(message);
            showResult("å‘é€é¢˜ç›® æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å‘é€é¢˜ç›® å¤±è´¥",message,start);
        }
    });
}


/*
å…¬ä¼—å·
RongIMLib.ConversationType = {
	APP_PUBLIC_SERVICE : "åº”ç”¨æœåŠ¡å¹³å° mc",
	PUBLIC_SERVICE : "å…¬ä¼—æœåŠ¡å¹³å° mp"
};
*/

var publicServiceType = RongIMLib.ConversationType.APP_PUBLIC_SERVICE; //å›ºå®šå€¼
var publicServiceId = "Rong_shuise"; //RongCloud
var searchType = 1; //[0-exact 1-fuzzy]
var keywords = "Rong";
// var keywords = "test";

/*
ç”¨æˆ·ç»™å…¬ä¼—å·å‘æ¶ˆæ¯
var conversationType = RongIMLib.ConversationType.PUBLIC_SERVICE;
var targetId = publicServiceId
*/

function sendToPublic(){
	/*
	æ–‡æ¡£ï¼š http://www.rongcloud.cn/docs/web.html#5_1ã€å‘é€æ¶ˆæ¯
		   http://rongcloud.cn/docs/api/js/TextMessage.html
	1: å•æ¡æ¶ˆæ¯æ•´ä½“ä¸å¾—å¤§äº128K
	2: conversatinType ç±»å‹æ˜¯ numberï¼ŒtargetId ç±»å‹æ˜¯ string
	*/

	var content = {
		content: "å…¬ä¼—å·ä½ å¥½"
	};

	var msg = new RongIMLib.TextMessage(content);

	var start = new Date().getTime();
	instance.sendMessage(publicServiceType, publicServiceId, msg, {
        onSuccess: function (message) {
            showResult("å…¬ä¼—å·ç•™è¨€ æˆåŠŸ",message,start);
        },
        onError: function (errorCode,message) {
            showResult("å…¬ä¼—å·ç•™è¨€ å¤±è´¥",message,start);
        }
    });
}

function getPublicHistroyMessage(){
	alert("æš‚ä¸æ”¯æŒ");

	// var count = 10;  // 2 <= count <= 20
	// var timestrap = null; //0, 1483950413013

	// var start = new Date().getTime();
	// instance.getHistoryMessages(publicServiceType, publicServiceId, timestrap, count, {
	// 	onSuccess: function(list, hasMsg) {
	// 	},
	// 	onError: function(error) {
	// 	}
	// });
} 

function getPublicServiceList(){
	/* 
	getRemotePublicServiceList = function (mpId, conversationType, pullMessageTime, callback)  
	*/ 
	var start = new Date().getTime();

	instance.getPublicServiceList({
	    onSuccess:function(list){
            showResult("è·å–å·²å…³æ³¨å…¬ä¼—å· æˆåŠŸ",list,start);
	    },
	    onError:function(error){
	    	showResult("æœç´¢è·å–å·²å…³æ³¨å…¬ä¼—å·å…¬ä¼—å· å¤±è´¥",error,start);
	    }
	});
}

function searchPublicService(){
	/*
	WebAPIæ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/api/js/RongIMClient.html
	iOSæ–‡æ¡£ï¼šhttp://www.rongcloud.cn/docs/ios_imlib.html#å…¬ä¼—æœåŠ¡
	*/ 
	var start = new Date().getTime();

	instance.searchPublicService(searchType, keywords, {
	    onSuccess:function(list){
            showResult("æŸ¥æ‰¾å…¬ä¼—å· æˆåŠŸ",list,start);
	    },
	    onError:function(error){
	    	showResult("æŸ¥æ‰¾å…¬ä¼—å· å¤±è´¥",error,start);
	    }
	});
}

// function searchPublicServiceByType(){
// 	var start = new Date().getTime();

// 	instance.searchPublicServiceByType(publicServiceType, searchType, keywords, {
// 	    onSuccess:function(list){
//             showTips("æœç´¢å…¬ä¼—å·by type æˆåŠŸ");
//             showResult("æœç´¢å…¬ä¼—å·by type æˆåŠŸ",list,start);
// 	    },
// 	    onError:function(error){
// 	    	showTips("æœç´¢å…¬ä¼—å·by type å¤±è´¥");
// 	    	showResult("æœç´¢å…¬ä¼—å·by type å¤±è´¥",error,start);
// 	    }
// 	});
// }

function subscribePublicService(){
	/*
	http://www.rongcloud.cn/docs/api/js/RongIMClient.html

	*/
	var start = new Date().getTime();

	instance.subscribePublicService(publicServiceType, publicServiceId, {
	    onSuccess:function(list){
            showResult("è®¢é˜…å…¬ä¼—å· æˆåŠŸ",list,start);
	    },
	    onError:function(error){
	    	showResult("è®¢é˜…å…¬ä¼—å· å¤±è´¥",error,start);
	    }
	});
}

function unsubscribePublicService(){
	/*
	http://www.rongcloud.cn/docs/api/js/RongIMClient.html
	
	*/
	var start = new Date().getTime();

	instance.unsubscribePublicService(publicServiceType, publicServiceId, {
	    onSuccess:function(list){
            showResult("å–æ¶ˆè®¢é˜…å…¬ä¼—å· æˆåŠŸ",list,start);
	    },
	    onError:function(error){
	    	showResult("å–æ¶ˆè®¢é˜…å…¬ä¼—å· å¤±è´¥",error,start);
	    }
	});
}

function getPublicServiceProfile(){
	/*
	http://www.rongcloud.cn/docs/api/js/RongIMClient.html

	å¿…é¡»æ˜¯å·²ç»å…³æ³¨çš„å…¬ä¼—å·ï¼Œæ‰èƒ½è·å–åˆ°è¯¦æƒ…
	*/
	var start = new Date().getTime();

	instance.getPublicServiceProfile(publicServiceType, publicServiceId, {
		onSuccess:function(profile){
            showResult("è·å–å…¬ä¼—å·è¯¦æƒ… æˆåŠŸ",profile,start);
		}, 
	  	onError:function(){
	  		cosnole.log("è·å–å…¬ä¼—å·è¯¦æƒ… error");
	  	}
	});
}

//è·å–base64å‡æ•°æ®æ–¹æ³•
function getBase64Image(){
	var canvas = document.createElement("canvas");
		canvas.width = 100;
		canvas.height = 100;


	var context = canvas.getContext("2d");	
		context.font = "20pt Arial";    			
		context.fillStyle = "blue"; 
		context.fillText("RongCloud.cn", 10, 20);
	var content = canvas.toDataURL("image/jpeg");
		content = content.replace("data:image/jpeg;base64,","");
	return content;
}

function setUserStatus(){
	/*
		è‡ªå®šä¹‰åœ¨çº¿çŠ¶æ€(ä¸¾ä¾‹)ï¼š
		
		1ã€åœ¨çº¿
			status : 10 

		2ã€ç¦»å¼€
			status : 11 

		3ã€å¿™ç¢Œ
			status : 12  

	*/
	var start = new Date().getTime();
	var status = 10;
	instance.setUserStatus(status, {
		onSuccess:function(status){
			// æ­¤æ—¶åˆ«äºº è°ƒç”¨ setUserStatusListener æŸ¥è¯¢å½“å‰ç”¨æˆ·çš„åœ¨çº¿çŠ¶æ€ status å€¼ä¸º 10ï¼›
            showResult("è®¾ç½®åœ¨çº¿çŠ¶æ€æˆåŠŸ", status, start);
		}, 
	  	onError:function(error){
	  		cosnole.log("è®¾ç½®åœ¨çº¿çŠ¶æ€ error:" + error);
	  	}
	});
}

function setUserStatusListener(){
	var start = new Date().getTime();
	var params =  {
		userIds: targetIds
	};
	// æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œé€ä¸ªè¿”å›
	instance.setUserStatusListener(params, function(userStatus){
		console.log(userStatus);
		/*
		userStatus ç»“æ„: {"status":[{"platform":["web"],"online":1,"status":10}],"userId":null}
		platform å¹³å°: web | Android | iOS | pc
		online åœ¨çº¿æ ‡ç¤º: 1 | 0 , 1 è¡¨ç¤ºåœ¨çº¿ï¼Œåä¹‹ä¸åœ¨çº¿ 
		status è‡ªå®šä¹‰çŠ¶æ€, é€šè¿‡ setUserStatus è®¾ç½®
		*/
		showResult("è·å–ç”¨æˆ·åœ¨çº¿çŠ¶æ€æˆåŠŸ", userStatus, start);
	});
}

</script>

<h1>Web SDK demo <small><a href="connect-check.html">æ¶ˆæ¯æ¥æ”¶demo</a></small></h1>
<button onclick="history.back()" style="display: none;" id="rong-home-page">ä¸»é¡µ</button>
<div class="panel" id="panel">
	<p>
		<span>appkey</span>
		<input type="text" id="appkey" size="20" value="8w7jv4qb78a9y">
	</p>
	<p>
		<span>token</span>
		<input type="text" id="token" size="90" _user="user10" value="4FGCL0oQ/E72nU4ivbui8uHR/ySxKaD1cAX2biXsYR6RsLYO9xAA4ooa+q3n42JnVTQyMAdFUiDsjFRDYZaQeg==">
		<!-- 
		8w7jv4qb78a9y
		user9	ZThhLI1Xa1BX5EMREAdArWSH6ouuI8NT/fNmMkzF+4IOKIoFvbsi6JnH8QmnSltLkCcsK8vOgKl3IZgfbxFiWg==
		user10	4FGCL0oQ/E72nU4ivbui8uHR/ySxKaD1cAX2biXsYR6RsLYO9xAA4ooa+q3n42JnVTQyMAdFUiDsjFRDYZaQeg== 
		user11	ovjkF2621YWp7odRhy9i6vHDlKxuUva3nL1owWyEuVOxBPB1/Pr1sY7ayEdnH2tgVyqC/Dcl95lDFEgeXzjaqQ==
		-->

		<!-- 
		82hegw5uh8ktx
		rybznHwVbrk7upeAMWv8RnHEDKuqy0jJayFPsQ4gP8z+SyAuRRg4uk2hA24NDcnvbl6oswAYXQCdpAbHm4pp9g==
		-->
	</p>
	<p>
		<span>token2</span>
		<input type="text" id="token2" size="90" _user="user11" value="ovjkF2621YWp7odRhy9i6vHDlKxuUva3nL1owWyEuVOxBPB1/Pr1sY7ayEdnH2tgVyqC/Dcl95lDFEgeXzjaqQ==">  &#160;&#160;<strong>åˆ‡æ¢æ–¹æ³•ä½¿ç”¨</strong>
	</p>
	<p>
		<span>targetIds</span>
		<input type="text" id="targetId" size="25" value="user9,user8">
		<em>é€—å·é—´éš”ï¼Œè‡³å°‘æä¾›ä¸¤ä¸ª</em>
	</p>
	<p>
		<span>&#160;</span>
		<input type="button" onclick="login()" value="åˆå§‹åŒ–">  &#160;&#160;<strong>æ‰€æœ‰ä¸šåŠ¡æ–¹æ³•éƒ½å¿…é¡»åœ¨ é“¾æ¥æˆåŠŸ ä¹‹åæ‰§è¡Œ</strong>
	</p>
</div>

<div class="btns" id="btns">
	<div class="title">
		<h2>å½“å‰ç™»å½•ç”¨æˆ· idï¼š<span id="login"></span></h2> 	
		<input type="button" value="åˆ‡æ¢ç”¨æˆ·" onclick="changeUser();">
	</div>

	é“¾æ¥çŠ¶æ€ï¼š
	<input type="button" value="æ–­å¼€é“¾æ¥" onclick="disconnect();">
	<input type="button" value="é‡æ–°é“¾æ¥" onclick="reconnect();">
	
	<br>


	å‘é€æ¶ˆæ¯ï¼š
	<input type="button" value="æ–‡å­—æ¶ˆæ¯(æºå¸¦ç”¨æˆ·ä¿¡æ¯)" onclick="sendTextMessage();">
	<input type="button" value="å›¾ç‰‡æ¶ˆæ¯" onclick="sendImageMessage();">
	<input type="button" value="æ–‡ä»¶æ¶ˆæ¯" onclick="sendFileMessage();">
	<input type="button" value="è¯­éŸ³æ¶ˆæ¯" onclick="sendVoiceMessage();">
	<br/>
	<input type="button" value="@ æ¶ˆæ¯" onclick="sendAtMessage();"> 
	<input type="button" value="å¯Œæ–‡æœ¬æ¶ˆæ¯" onclick="sendRichContentMessage();">
	<input type="button" value="è‡ªå®šä¹‰æ¶ˆæ¯" onclick="sendRegisterMessage();">
	<input type="button" value="ä½ç½®æ¶ˆæ¯" onclick="sendLocationMessage();"> 
	<input type="button" value="æ¶ˆæ¯æ’¤å›" onclick="sendRecallMessage();"> 

	<br>

	æ¥æ”¶æ¶ˆæ¯ï¼š
	<input type="button" value="åŒæ­¥çŠ¶æ€æ¶ˆæ¯" onclick="SendSyncReadStatusMessage();">
	<input type="button" value="æ£€æŸ¥æœªè¯»æ¶ˆæ¯" onclick="checkUnreadMessage();"> 
	<input type="button" value="æ¶ˆæ¯æ¥æ”¶" onclick="receiveMessage();"> 
	
	<br>
	å†å²æ¶ˆæ¯ï¼š
	<input type="button" value="è·å–åˆ—è¡¨" onclick="getHistroyMessage();"> 
	<input type="button" value="æ¸…ç©ºå…¨éƒ¨" onclick="clearHistroyMessage();"> 

	<br>

	ä¼š&nbsp;&nbsp;è¯ï¼š
	<input type="button" value="ä¼šè¯åˆ—è¡¨" onclick="getConversationList();">
	<input type="button" value="è·å–ä¼šè¯" title="éœ€è¦åœ¨è·å–ä¼šè¯åˆ—è¡¨ä¹‹åæ‰§è¡Œ" onclick="getConversation();">
	<input type="button" value="ä¼šè¯æœªè¯»æ•°" onclick="getUnreadCount();"> 
	<input type="button" value="ä¼šè¯æœªè¯»æ€»æ•°" onclick="getTotalUnreadCount();"> 
	<br/>
	<input type="button" value="æ¸…é™¤ä¼šè¯æœªè¯»æ•°" onclick="clearUnreadCount();">
	<input type="button" value="æ¸…é™¤å…¨éƒ¨æœªè¯»æ•°" onclick="clearTotalUnreadCount();">
	<input type="button" value="åˆ é™¤æŒ‡å®šä¼šè¯" onclick="removeConversation();">
	<input type="button" value="åˆ é™¤æ‰€æœ‰ä¼šè¯" onclick="clearConversation();">

	<br>

	èŠ å¤© å®¤ï¼š
	<input type="button" value="åŠ å…¥èŠå¤©å®¤" onclick="enterChatroom();"> 
	<input type="button" value="èŠå¤©å®¤å‘æ¶ˆæ¯" onclick="sendMessageToChatroom();"> 
	<input type="button" value="èŠå¤©å®¤å‘é¢˜ç›®" onclick="sendQAMessage();"> 
	<input type="button" value="é€€å‡ºèŠå¤©å®¤" onclick="quitChatroom();"> 
	<input type="button" value="è·å–èŠå¤©å®¤ä¿¡æ¯" onclick="getChatroomInfo();"> 
	
	<br>
	
	åœ¨çº¿çŠ¶æ€ï¼š
	<input type="button" value="è®¾ç½®è‡ªå·±åœ¨çº¿çŠ¶æ€" onclick="setUserStatus();"> 
	<input type="button" value="æŸ¥è¯¢å…¶ä»–äººåœ¨çº¿çŠ¶æ€" onclick="setUserStatusListener();"> 
	<br>
	
	<div class="rong-public-service" id="rong-public-service">
		å…¬ä¼—æœåŠ¡ï¼š
		<input type="button" value="è·å–å·²å…³æ³¨å…¬ä¼—å·" onclick="getPublicServiceList();"> 
		<input type="button" value="æŸ¥æ‰¾å…¬ä¼—å·" onclick="searchPublicService();"> 
		<!-- <input type="button" value="æŸ¥æ‰¾å…¬ä¼—å· byType" onclick="searchPublicServiceByType();">  -->
		<input type="button" value="è®¢é˜…å…¬ä¼—å·" onclick="subscribePublicService();"> 
		<input type="button" value="å–æ¶ˆè®¢é˜…å…¬ä¼—å·" onclick="unsubscribePublicService();"> 
		<input type="button" value="è·å–å…¬ä¼—å·ä¿¡æ¯" onclick="getPublicServiceProfile();"> 
		<input type="button" value="ç»™å…¬ä¼—å·ç•™è¨€" onclick="sendToPublic();"> 
		<input type="button" value="å…¬ä¼—å·å†å²ç•™è¨€" onclick="getPublicHistroyMessage();"> 
	</div>
	<br>
</div>

<div class="result" id="result-area">
	<h3 id="result-title">è¿è¡Œç»“æœï¼š</h3>

	<div class="result-btns">
		<button id="collapse-btn">Collapse</button>
		<button id="expand-btn">Expand</button>
		<button id="toggle-btn">Toggle</button>
		<button id="toggle-level1-btn">Toggle level1</button>
		<button id="toggle-level2-btn">Toggle level2</button>
		
		<button class="result-code" id="result-code-btn">æŸ¥çœ‹ä»£ç </button>
	</div>

	<div id="result-body"></div>
</div>


<ol id="show" class="show"></ol>
<div id="show1"></div>
<script>
(function(){
	var t = document.getElementById("btns");
	var _code = document.getElementById("result-code-btn");
	var _funcName = "", _btnName = "";
	t.onclick = function(event){
		var e = event || window.event;
		var node = e.target || e.srcElement;
		var tagName = node.tagName.toLowerCase();
		if(tagName == "input"){
			_funcName = node.getAttribute("onclick").split("(")[0];
			_btnName = node.innerHTML;
		}
	}
	_code.onclick = function(){
		var code = window[_funcName] + "";

		var start = new Date().getTime();
		showResult(_btnName, window[_funcName], start);
	}
})();
</script>

</body>
</html>